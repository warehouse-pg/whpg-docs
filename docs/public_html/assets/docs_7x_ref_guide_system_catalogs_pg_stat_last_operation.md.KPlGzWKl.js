import{_ as e,c as a,o as s,ag as o}from"./chunks/framework.Ds6Eueu6.js";const _=JSON.parse('{"title":"pg_stat_last_operation","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/ref_guide/system_catalogs/pg_stat_last_operation.md","filePath":"docs/7x/ref_guide/system_catalogs/pg_stat_last_operation.md"}'),n={name:"docs/7x/ref_guide/system_catalogs/pg_stat_last_operation.md"};function d(i,t,p,c,r,l){return s(),a("div",null,t[0]||(t[0]=[o(`<h1 id="pg-stat-last-operation" tabindex="-1">pg_stat_last_operation <a class="header-anchor" href="#pg-stat-last-operation" aria-label="Permalink to &quot;pg_stat_last_operation&quot;">â€‹</a></h1><p>The pg_stat_last_operation table contains metadata tracking information about database objects (tables, views, etc.).</p><table tabindex="0"><thead><tr><th>column</th><th>type</th><th>references</th><th>description</th></tr></thead><tbody><tr><td><code>classid</code></td><td>oid</td><td>pg_class.oid</td><td>OID of the system catalog containing the object.</td></tr><tr><td><code>objid</code></td><td>oid</td><td>any OID column</td><td>OID of the object within its system catalog.</td></tr><tr><td><code>staactionname</code></td><td>name</td><td></td><td>The action that was taken on the object.</td></tr><tr><td><code>stasysid</code></td><td>oid</td><td>pg_authid.oid</td><td>A foreign key to pg_authid.oid.</td></tr><tr><td><code>stausename</code></td><td>name</td><td></td><td>The name of the role that performed the operation on this object.</td></tr><tr><td><code>stasubtype</code></td><td>text</td><td></td><td>The type of object operated on or the subclass of operation performed.</td></tr><tr><td><code>statime</code></td><td>timestamp with timezone</td><td></td><td>The timestamp of the operation. This is the same timestamp that is written to the WarehousePG server log files in case you need to look up more detailed information about the operation in the logs.</td></tr></tbody></table><p>The <code>pg_stat_last_operation</code> table contains metadata tracking information about operations on database objects. This information includes the object id, DDL action, user, type of object, and operation timestamp. WarehousePG updates this table when a database object is created, altered, truncated, vacuumed, analyzed, or partitioned, and when privileges are granted to an object.</p><p>If you want to track the operations performed on a specific object, use the <code>objid</code> value. Because the <code>stasubtype</code> value can identify either the type of object operated on or the subclass of operation performed, it is not a suitable parameter when querying the <code>pg_stat_last_operation</code> table.</p><p>The following example creates and replaces a view, and then shows how to use <code>objid</code> as a query parameter on the <code>pg_stat_last_operation</code> table.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>testdb=# CREATE VIEW trial AS SELECT * FROM gp_segment_configuration;</span></span>
<span class="line"><span>CREATE VIEW</span></span>
<span class="line"><span>testdb=# CREATE OR REPLACE VIEW trial AS SELECT * FROM gp_segment_configuration;</span></span>
<span class="line"><span>CREATE VIEW</span></span>
<span class="line"><span>testdb=# SELECT * FROM pg_stat_last_operation WHERE objid=&#39;trial&#39;::regclass::oid;</span></span>
<span class="line"><span> classid | objid | staactionname | stasysid | stausename | stasubtype |            statime            </span></span>
<span class="line"><span>---------+-------+---------------+----------+------------+------------+-------------------------------</span></span>
<span class="line"><span>  1259  | 24735 | CREATE         |       10 | gpadmin    | VIEW       | 2020-04-07 16:44:28.808811+00</span></span>
<span class="line"><span>  1259  | 24735 | ALTER          |       10 | gpadmin    | SET        | 2020-04-07 16:44:38.110615+00</span></span>
<span class="line"><span>(2 rows)</span></span></code></pre></div><p>Notice that the <code>pg_stat_last_operation</code> table entry for the view <code>REPLACE</code> operation specifies the <code>ALTER</code> action (<code>staactionname</code>) and the <code>SET</code> subtype (<code>stasubtype</code>).</p><p><strong>Parent topic:</strong> <a href="./../system_catalogs/catalog_ref-html.html">System Catalogs Definitions</a></p>`,9)]))}const m=e(n,[["render",d]]);export{_ as __pageData,m as default};
