import{_ as a,c as t,o as s,ag as o}from"./chunks/framework.Ds6Eueu6.js";const u=JSON.parse('{"title":"REINDEX","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/ref_guide/sql_commands/REINDEX.md","filePath":"docs/7x/ref_guide/sql_commands/REINDEX.md"}'),n={name:"docs/7x/ref_guide/sql_commands/REINDEX.md"};function i(d,e,r,c,l,p){return s(),t("div",null,e[0]||(e[0]=[o(`<h1 id="reindex" tabindex="-1">REINDEX <a class="header-anchor" href="#reindex" aria-label="Permalink to &quot;REINDEX&quot;">​</a></h1><p>Rebuilds indexes.</p><h2 id="synopsis" tabindex="-1"><a id="section2"></a>Synopsis <a class="header-anchor" href="#synopsis" aria-label="Permalink to &quot;&lt;a id=&quot;section2&quot;&gt;&lt;/a&gt;Synopsis&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>REINDEX [ (VERBOSE) ] { INDEX | TABLE | SCHEMA | DATABASE | SYSTEM } &lt;name&gt;</span></span></code></pre></div><h2 id="description" tabindex="-1"><a id="section3"></a>Description <a class="header-anchor" href="#description" aria-label="Permalink to &quot;&lt;a id=&quot;section3&quot;&gt;&lt;/a&gt;Description&quot;">​</a></h2><p><code>REINDEX</code> rebuilds an index using the data stored in the index&#39;s table, replacing the old copy of the index. There are several scenarios in which to use <code>REINDEX</code>:</p><ul><li>An index has become corrupted, and no longer contains valid data. Although in theory this should never happen, in practice indexes can become corrupted due to software bugs or hardware failures. <code>REINDEX</code> provides a recovery method.</li><li>An index has become bloated, that is, it contains many empty or nearly-empty pages. This can occur with B-tree indexes in WarehousePG under certain uncommon access patterns. <code>REINDEX</code> provides a way to reduce the space consumption of the index by writing a new version of the index without the dead pages.</li><li>You have altered a storage parameter (such as <code>fillfactor</code>) for an index, and wish to ensure that the change has taken full effect.</li></ul><h2 id="parameters" tabindex="-1"><a id="section4"></a>Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to &quot;&lt;a id=&quot;section4&quot;&gt;&lt;/a&gt;Parameters&quot;">​</a></h2><p>INDEX : Recreate the specified index.</p><p>TABLE : Recreate all indexes of the specified table. If the table has a secondary &quot;TOAST&quot; table, that is reindexed as well.</p><p>SCHEMA : Recreate all indexes of the specified schema. If a table of this schema has a secondary &quot;TOAST&quot; table, that is reindexed as well. Indexes on shared system catalogs are also processed. You cannot run this form of <code>REINDEX</code> inside a transaction block.</p><p>DATABASE : Recreate all indexes within the current database. Indexes on shared system catalogs are also processed. This form of <code>REINDEX</code> cannot be run inside a transaction block.</p><p>SYSTEM : Recreate all indexes on system catalogs within the current database. Indexes on shared system catalogs are included. Indexes on user tables are not processed. This form of <code>REINDEX</code> cannot be run inside a transaction block.</p><p>name : The name of the specific index, table, or database to be reindexed. Index and table names may be schema-qualified. Presently, <code>REINDEX DATABASE</code> and <code>REINDEX SYSTEM</code> can only reindex the current database, so their parameter must match the current database&#39;s name.</p><p>VERBOSE : Prints a progress report as each index is reindexed.</p><h2 id="notes" tabindex="-1"><a id="section5"></a>Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;&lt;a id=&quot;section5&quot;&gt;&lt;/a&gt;Notes&quot;">​</a></h2><p>WarehousePG does not support concurrently recreating indexes (<code>CONCURRENTLY</code> keyword is not supported).</p><p><code>REINDEX</code> causes locking of system catalog tables, which could affect currently running queries. To avoid disrupting ongoing business operations, schedule the <code>REINDEX</code> operation during a period of low activity.</p><p><code>REINDEX</code> is similar to a drop and recreate of the index in that the index contents are rebuilt from scratch. However, the locking considerations are rather different. <code>REINDEX</code> locks out writes but not reads of the index&#39;s parent table. It also takes an <code>ACCESS EXCLUSIVE</code> lock on the specific index being processed, which will block reads that attempt to use that index. In contrast, <code>DROP INDEX</code> momentarily takes an <code>ACCESS EXCLUSIVE</code> lock on the parent table, blocking both writes and reads. The subsequent <code>CREATE INDEX</code> locks out writes but not reads; since the index is not there, no read will attempt to use it, meaning that there will be no blocking but reads may be forced into expensive sequential scans.</p><p>Reindexing a single index or table requires being the owner of that index or table. Reindexing a schema or database requires being the owner of the schema or database. Note that it is therefore sometimes possible for non-superusers to rebuild indexes of tables owned by other users. However, as a special exception, when a non-superuser issues <code>REINDEX DATABASE</code>, <code>REINDEX SCHEMA</code> or <code>REINDEX SYSTEM</code>, WarehousePG skips indexes on shared catalogs unless the user owns the catalog (which typically won&#39;t be the case). Of course, superusers can always reindex anything.</p><p>REINDEX<code>does not update the</code>reltuples<code>and</code>relpages<code>statistics for the index. To update those statistics, run</code>ANALYZE\` on the table after reindexing.</p><h2 id="examples" tabindex="-1"><a id="section6"></a>Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;&lt;a id=&quot;section6&quot;&gt;&lt;/a&gt;Examples&quot;">​</a></h2><p>Rebuild a single index:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>REINDEX INDEX my_index;</span></span></code></pre></div><p>Rebuild all the indexes on the table <code>my_table</code>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>REINDEX TABLE my_table;</span></span></code></pre></div><p>Rebuild all indexes in a particular database, without trusting the system indexes to be valid already:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ export PGOPTIONS=&quot;-P&quot;</span></span>
<span class="line"><span>$ psql broken_db</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>broken_db=&gt; REINDEX DATABASE broken_db;</span></span>
<span class="line"><span>broken_db=&gt; \\q</span></span></code></pre></div><h2 id="compatibility" tabindex="-1"><a id="section7"></a>Compatibility <a class="header-anchor" href="#compatibility" aria-label="Permalink to &quot;&lt;a id=&quot;section7&quot;&gt;&lt;/a&gt;Compatibility&quot;">​</a></h2><p>There is no <code>REINDEX</code> command in the SQL standard.</p><h2 id="see-also" tabindex="-1"><a id="section8"></a>See Also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;&lt;a id=&quot;section8&quot;&gt;&lt;/a&gt;See Also&quot;">​</a></h2><p><a href="./CREATE_INDEX.html">CREATE INDEX</a>, <a href="./DROP_INDEX.html">DROP INDEX</a>, <a href="./VACUUM.html">VACUUM</a>, <a href="./../../utility_guide/ref/reindexdb.html">reindexdb</a></p><p><strong>Parent topic:</strong> <a href="./../sql_commands/sql_ref.html">SQL Commands</a></p>`,33)]))}const b=a(n,[["render",i]]);export{u as __pageData,b as default};
