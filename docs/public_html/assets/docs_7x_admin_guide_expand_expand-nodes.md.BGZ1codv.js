import{_ as s,c as a,o as t,ag as n}from"./chunks/framework.Ds6Eueu6.js";const g=JSON.parse('{"title":"Preparing and Adding Hosts","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/admin_guide/expand/expand-nodes.md","filePath":"docs/7x/admin_guide/expand/expand-nodes.md"}'),o={name:"docs/7x/admin_guide/expand/expand-nodes.md"};function i(d,e,p,h,r,l){return t(),a("div",null,e[0]||(e[0]=[n(`<h1 id="preparing-and-adding-hosts" tabindex="-1">Preparing and Adding Hosts <a class="header-anchor" href="#preparing-and-adding-hosts" aria-label="Permalink to &quot;Preparing and Adding Hosts&quot;">​</a></h1><hr><p>Verify your new host systems are ready for integration into the existing WarehousePG cluster.</p><p>To prepare new host systems for expansion, install the WarehousePG software binaries, exchange the required SSH keys, and run performance tests.</p><p>Run performance tests first on the new hosts and then all hosts. Run the tests on all hosts with the system offline so user activity does not distort results.</p><p>Generally, you should run performance tests when an administrator modifies host networking or other special conditions in the system. For example, if you will run the expanded system on two network clusters, run tests on each cluster.</p><blockquote><p><strong>Note</strong> Preparing host systems for use by a WarehousePG cluster assumes that the new hosts&#39; operating system has been properly configured to match the existing hosts, described in <a href="./../../install_guide/config_os.html">Configure Operating System</a>.</p></blockquote><p><strong>Parent topic:</strong> <a href="./../expand/expand-main.html">Expanding a WarehousePG cluster</a></p><h2 id="adding-new-hosts-to-the-trusted-host-environment" tabindex="-1"><a id="topic18"></a>Adding New Hosts to the Trusted Host Environment <a class="header-anchor" href="#adding-new-hosts-to-the-trusted-host-environment" aria-label="Permalink to &quot;&lt;a id=&quot;topic18&quot;&gt;&lt;/a&gt;Adding New Hosts to the Trusted Host Environment&quot;">​</a></h2><p>New hosts must exchange SSH keys with the existing hosts to enable WarehousePG administrative utilities to connect to all segments without a password prompt. Perform the key exchange process twice with the <a href="./../../utility_guide/ref/gpssh-exkeys.html">gpssh-exkeys</a> utility.</p><p>First perform the process as <code>root</code>, for administration convenience, and then as the user <code>gpadmin</code>, for management utilities. Perform the following tasks in order:</p><ol><li><a href="#no160715">To exchange SSH keys as root</a></li><li><a href="#no160595">To create the gpadmin user</a></li><li><a href="#sshexch_gpadmin">To exchange SSH keys as the gpadmin user</a></li></ol><blockquote><p><strong>Note</strong> The WarehousePG segment host naming convention is <code>sdwN</code> where <code>sdw</code> is a prefix and <code>N</code> is an integer ( <code>sdw1</code>, <code>sdw2</code> and so on). For hosts with multiple interfaces, the convention is to append a dash (<code>-</code>) and number to the host name. For example, <code>sdw1-1</code> and <code>sdw1-2</code> are the two interface names for host <code>sdw1</code>.</p></blockquote><h3 id="to-exchange-ssh-keys-as-root" tabindex="-1"><a id="no160715"></a>To exchange SSH keys as root <a class="header-anchor" href="#to-exchange-ssh-keys-as-root" aria-label="Permalink to &quot;&lt;a id=&quot;no160715&quot;&gt;&lt;/a&gt;To exchange SSH keys as root&quot;">​</a></h3><ol><li><p>Create a host file with the existing host names in your array and a separate host file with the new expansion host names. For existing hosts, you can use the same host file used to set up SSH keys in the system. In the files, list all hosts (coordinator, backup coordinator, and segment hosts) with one name per line and no extra lines or spaces. Exchange SSH keys using the configured host names for a given host if you use a multi-NIC configuration. In this example, <code>cdw</code> is configured with a single NIC, and <code>sdw1</code>, <code>sdw2</code>, and <code>sdw3</code> are configured with 4 NICs:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>cdw</span></span>
<span class="line"><span>sdw1-1</span></span>
<span class="line"><span>sdw1-2</span></span>
<span class="line"><span>sdw1-3</span></span>
<span class="line"><span>sdw1-4</span></span>
<span class="line"><span>sdw2-1</span></span>
<span class="line"><span>sdw2-2</span></span>
<span class="line"><span>sdw2-3</span></span>
<span class="line"><span>sdw2-4</span></span>
<span class="line"><span>sdw3-1</span></span>
<span class="line"><span>sdw3-2</span></span>
<span class="line"><span>sdw3-3</span></span>
<span class="line"><span>sdw3-4</span></span></code></pre></div></li><li><p>Log in as <code>root</code> on the coordinator host, and source the <code>greenplum_path.sh</code> file from your WarehousePG installation.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ su - </span></span>
<span class="line"><span># source /usr/local/greenplum-db/greenplum_path.sh</span></span></code></pre></div></li><li><p>Run the <code>gpssh-exkeys</code> utility referencing the host list files. For example:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># gpssh-exkeys -e /home/gpadmin/&lt;existing_hosts_file&gt; -x </span></span>
<span class="line"><span>/home/gpadmin/&lt;new_hosts_file&gt;</span></span></code></pre></div></li><li><p><code>gpssh-exkeys</code> checks the remote hosts and performs the key exchange between all hosts. Enter the <code>root</code> user password when prompted. For example:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>***Enter password for root@&lt;hostname&gt;: &lt;root_password&gt;</span></span></code></pre></div></li></ol><h3 id="to-create-the-gpadmin-user" tabindex="-1"><a id="no160595"></a>To create the gpadmin user <a class="header-anchor" href="#to-create-the-gpadmin-user" aria-label="Permalink to &quot;&lt;a id=&quot;no160595&quot;&gt;&lt;/a&gt;To create the gpadmin user&quot;">​</a></h3><ol><li><p>Use <a href="./../../utility_guide/ref/gpssh.html">gpssh</a> to create the <code>gpadmin</code> user on all the new segment hosts (if it does not exist already). Use the list of new hosts you created for the key exchange. For example:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># gpssh -f &lt;new_hosts_file&gt; &#39;/usr/sbin/useradd gpadmin -d </span></span>
<span class="line"><span>/home/gpadmin -s /bin/bash&#39;</span></span></code></pre></div></li><li><p>Set a password for the new <code>gpadmin</code> user. On Linux, you can do this on all segment hosts simultaneously using <code>gpssh</code>. For example:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># gpssh -f &lt;new_hosts_file&gt; &#39;echo &lt;gpadmin_password&gt; | passwd </span></span>
<span class="line"><span>gpadmin --stdin&#39;</span></span></code></pre></div></li><li><p>Verify the <code>gpadmin</code> user has been created by looking for its home directory:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># gpssh -f &lt;new_hosts_file&gt; ls -l /home</span></span></code></pre></div></li></ol><h3 id="to-exchange-ssh-keys-as-the-gpadmin-user" tabindex="-1"><a id="sshexch_gpadmin"></a>To exchange SSH keys as the gpadmin user <a class="header-anchor" href="#to-exchange-ssh-keys-as-the-gpadmin-user" aria-label="Permalink to &quot;&lt;a id=&quot;sshexch_gpadmin&quot;&gt;&lt;/a&gt;To exchange SSH keys as the gpadmin user&quot;">​</a></h3><ol><li><p>Log in as <code>gpadmin</code> and run the <code>gpssh-exkeys</code> utility referencing the host list files. For example:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># gpssh-exkeys -e /home/gpadmin/&lt;existing_hosts_file&gt; -x </span></span>
<span class="line"><span>/home/gpadmin/&lt;new_hosts_file&gt;</span></span></code></pre></div></li><li><p><code>gpssh-exkeys</code> will check the remote hosts and perform the key exchange between all hosts. Enter the <code>gpadmin</code> user password when prompted. For example:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>***Enter password for gpadmin@&lt;hostname&gt;: &lt;gpadmin_password&gt;</span></span></code></pre></div></li></ol><h2 id="validating-disk-i-o-and-memory-bandwidth" tabindex="-1"><a id="topic20"></a>Validating Disk I/O and Memory Bandwidth <a class="header-anchor" href="#validating-disk-i-o-and-memory-bandwidth" aria-label="Permalink to &quot;&lt;a id=&quot;topic20&quot;&gt;&lt;/a&gt;Validating Disk I/O and Memory Bandwidth&quot;">​</a></h2><p>Use the <a href="./../../utility_guide/ref/gpcheckperf.html">gpcheckperf</a> utility to test disk I/O and memory bandwidth.</p><h3 id="to-run-gpcheckperf" tabindex="-1"><a id="no159247"></a>To run gpcheckperf <a class="header-anchor" href="#to-run-gpcheckperf" aria-label="Permalink to &quot;&lt;a id=&quot;no159247&quot;&gt;&lt;/a&gt;To run gpcheckperf&quot;">​</a></h3><ol><li><p>Run the <code>gpcheckperf</code> utility using the host file for new hosts. Use the <code>-d</code> option to specify the file systems you want to test on each host. You must have write access to these directories. For example:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gpcheckperf -f &lt;new_hosts_file&gt; -d /data1 -d /data2 -v</span></span></code></pre></div></li><li><p>The utility may take a long time to perform the tests because it is copying very large files between the hosts. When it is finished, you will see the summary results for the Disk Write, Disk Read, and Stream tests.</p></li></ol><p>For a network divided into subnets, repeat this procedure with a separate host file for each subnet.</p><h2 id="integrating-new-hardware-into-the-system" tabindex="-1"><a id="topic21"></a>Integrating New Hardware into the System <a class="header-anchor" href="#integrating-new-hardware-into-the-system" aria-label="Permalink to &quot;&lt;a id=&quot;topic21&quot;&gt;&lt;/a&gt;Integrating New Hardware into the System&quot;">​</a></h2><p>Before initializing the system with the new segments, shut down the system with <code>gpstop</code> to prevent user activity from skewing performance test results. Then, repeat the performance tests using host files that include <em>all</em> hosts, existing and new.</p>`,26)]))}const u=s(o,[["render",i]]);export{g as __pageData,u as default};
