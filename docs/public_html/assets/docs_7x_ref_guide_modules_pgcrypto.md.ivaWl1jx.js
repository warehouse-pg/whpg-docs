import{_ as t,c as o,o as a,ag as s}from"./chunks/framework.Ds6Eueu6.js";const g=JSON.parse('{"title":"pgcrypto","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/ref_guide/modules/pgcrypto.md","filePath":"docs/7x/ref_guide/modules/pgcrypto.md"}'),i={name:"docs/7x/ref_guide/modules/pgcrypto.md"};function n(d,e,p,c,r,l){return a(),o("div",null,e[0]||(e[0]=[s('<h1 id="pgcrypto" tabindex="-1">pgcrypto <a class="header-anchor" href="#pgcrypto" aria-label="Permalink to &quot;pgcrypto&quot;">​</a></h1><p>WarehousePG is installed with an optional module of encryption/decryption functions called <code>pgcrypto</code>. The <code>pgcrypto</code> functions allow database administrators to store certain columns of data in encrypted form. This adds an extra layer of protection for sensitive data, as data stored in WarehousePG in encrypted form cannot be read by anyone who does not have the encryption key, nor can it be read directly from the disks.</p><blockquote><p><strong>Note</strong> The <code>pgcrypto</code> functions run inside the database server, which means that all the data and passwords move between <code>pgcrypto</code> and the client application in clear-text. For optimal security, consider also using SSL connections between the client and the WarehousePG coordinator server.</p></blockquote><h2 id="installing-and-registering-the-module" tabindex="-1"><a id="topic_reg"></a>Installing and Registering the Module <a class="header-anchor" href="#installing-and-registering-the-module" aria-label="Permalink to &quot;&lt;a id=&quot;topic_reg&quot;&gt;&lt;/a&gt;Installing and Registering the Module&quot;">​</a></h2><p>The <code>pgcrypto</code> module is installed when you install WarehousePG. Before you can use any of the functions defined in the module, you must register the <code>pgcrypto</code> extension in each database in which you want to use the functions. Refer to <a href="./../../install_guide/install_extensions.html">Installing Extensions</a> for more information.</p><h2 id="configuring-fips-encryption" tabindex="-1"><a id="configuring-fips-encryption"></a>Configuring FIPS Encryption <a class="header-anchor" href="#configuring-fips-encryption" aria-label="Permalink to &quot;&lt;a id=&quot;configuring-fips-encryption&quot;&gt;&lt;/a&gt;Configuring FIPS Encryption&quot;">​</a></h2><p>Starting with WarehousePG 6.22, the <code>pgcrypto</code> extension provides a module-specific configuration parameter, <code>pgcrypto.fips</code>. This parameter configures WarehousePG support for a limited set of FIPS encryption functionality (<em>Federal Information Processing Standard</em> (FIPS) 140-2). For information about FIPS, see <a href="https://www.nist.gov/itl/popular-links/federal-information-processing-standards-fips" target="_blank" rel="noreferrer">https://www.nist.gov/itl/popular-links/federal-information-processing-standards-fips</a>. The default setting is <code>off</code>, FIPS encryption is not enabled.</p><p>Before enabling this parameter, ensure that FIPS is enabled on all WarehousePG cluster hosts.</p><p>When this parameter is enabled, these changes occur:</p><ul><li>FIPS mode is initialized in the OpenSSL library</li><li>The functions <code>digest()</code> and <code>hmac()</code> allow only the SHA encryption algorithm (MD5 is not allowed)</li><li>The functions for the crypt and gen_salt algorithms are disabled</li><li>PGP encryption and decryption functions support only AES and 3DES encryption algorithms (other algorithms such as blowfish are not allowed)</li><li>RAW encryption and decryption functions support only AES and 3DES (other algorithms such as blowfish are not allowed)</li></ul><p><strong>To enable <code>pgcrypto.fips</code></strong></p><ol><li><p>Enable the <code>pgcrypto</code> functions as an extension if it is not enabled. See <a href="./../../install_guide/install_extensions.html">Installing Extensions</a>. This example <code>psql</code> command creates the <code>pgcrypto</code> extension in the database <code>testdb</code>.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>psql -d testdb -c &#39;CREATE EXTENSION pgcrypto&#39;</span></span></code></pre></div></li><li><p>Configure the WarehousePG server configuration parameter <code>shared_preload_libraries</code> to load the <code>pgcrypto</code> library. This example uses the <code>gpconfig</code> utility to update the parameter in the WarehousePG <code>postgresql.conf</code> files.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>gpconfig -c shared_preload_libraries -v &#39;$libdir/pgcrypto&#39;</span></span></code></pre></div><p>This command displays the value of <code>shared_preload_libraries</code>.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>gpconfig -s shared_preload_libraries</span></span></code></pre></div></li><li><p>Restart the WarehousePG cluster.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>gpstop -ra</span></span></code></pre></div></li><li><p>Set the <code>pgcrypto.fips</code> server configuration parameter to <code>on</code> for each database that uses FIPS encryption. For example, these commands set the parameter to <code>on</code> for the database <code>testdb</code>.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>psql -d postgres</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ALTER DATABASE testdb SET pgcrypto.fips TO on;</span></span></code></pre></div><blockquote><p><strong>Important</strong> You must use the <code>ALTER DATABASE</code> command to set the parameter. You cannot use the <code>SET</code> command that updates the parameter for a session, or use the <code>gpconfig</code> utility that updates <code>postgresql.conf</code> files.</p></blockquote></li><li><p>After setting the parameter, reconnect to the database to enable encryption support for a session. This example uses the <code>psql</code> meta command <code>\\c</code> to connect to the <code>testdb</code> database.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>\\c testdb</span></span></code></pre></div></li></ol><p><strong>To disable <code>pgcrypto.fips</code></strong></p><ol><li><p>If the database does not use <code>pgcrypto</code> functions, disable the <code>pgcrypto</code> extension. This example <code>psql</code> command drops the <code>pgcrypto</code> extension in the database <code>testdb</code>.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>psql -d testdb -c &#39;DROP EXTENSION pgcrypto&#39;</span></span></code></pre></div></li><li><p>Remove <code>\\$libdir/pgcrypto</code> from the <code>shared_preload_libraries</code> parameter, and restart WarehousePG. This <code>gpconfig</code> command displays the value of the parameter from the WarehousePG <code>postgresql.conf</code> files.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>gpconfig -s shared_preload_libraries</span></span></code></pre></div><p>Use the <code>gpconfig</code> utility with the <code>-c</code> and <code>-v</code> options to change the value of the parameter. Use the <code>-r</code> option to remove the parameter.</p></li><li><p>Restart the WarehousePG cluster.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>gpstop -ra</span></span></code></pre></div></li></ol><h2 id="additional-module-documentation" tabindex="-1"><a id="topic_info"></a>Additional Module Documentation <a class="header-anchor" href="#additional-module-documentation" aria-label="Permalink to &quot;&lt;a id=&quot;topic_info&quot;&gt;&lt;/a&gt;Additional Module Documentation&quot;">​</a></h2><p>Refer to <a href="https://www.postgresql.org/docs/12/pgcrypto.html" target="_blank" rel="noreferrer">pgcrypto</a> in the PostgreSQL documentation for more information about the individual functions in this module.</p>',16)]))}const u=t(i,[["render",n]]);export{g as __pageData,u as default};
