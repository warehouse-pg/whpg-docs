import{_ as t,c as a,o as s,ag as o}from"./chunks/framework.Ds6Eueu6.js";const u=JSON.parse('{"title":"RETRIEVE","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/ref_guide/sql_commands/RETRIEVE.md","filePath":"docs/7x/ref_guide/sql_commands/RETRIEVE.md"}'),i={name:"docs/7x/ref_guide/sql_commands/RETRIEVE.md"};function r(n,e,p,l,c,d){return s(),a("div",null,e[0]||(e[0]=[o(`<h1 id="retrieve" tabindex="-1">RETRIEVE <a class="header-anchor" href="#retrieve" aria-label="Permalink to &quot;RETRIEVE&quot;">​</a></h1><p>Retrieves rows from a query using a parallel retrieve cursor.</p><h2 id="synopsis" tabindex="-1"><a id="section2"></a>Synopsis <a class="header-anchor" href="#synopsis" aria-label="Permalink to &quot;&lt;a id=&quot;section2&quot;&gt;&lt;/a&gt;Synopsis&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>RETRIEVE { &lt;count&gt; | ALL } FROM ENDPOINT &lt;endpoint_name&gt;</span></span></code></pre></div><h2 id="description" tabindex="-1"><a id="section3"></a>Description <a class="header-anchor" href="#description" aria-label="Permalink to &quot;&lt;a id=&quot;section3&quot;&gt;&lt;/a&gt;Description&quot;">​</a></h2><p><code>RETRIEVE</code> retrieves rows using a previously-created parallel retrieve cursor. You retrieve the rows in individual retrieve sessions, separate direct connections to individual segment endpoints that will serve the results for each individual segment. When you initiate a retrieve session, you must specify <a href="./../config_params/guc-list.html#gp_retrieve_conn">gp_retrieve_conn=true</a> on the connection request. Because a retrieve session is independent of the parallel retrieve cursors or their corresponding endpoints, you can <code>RETRIEVE</code> from multiple endpoints in the same retrieve session.</p><p>A parallel retrieve cursor has an associated position, which is used by <code>RETRIEVE</code>. The cursor position can be before the first row of the query result, on any particular row of the result, or after the last row of the result.</p><blockquote><p><strong>Note</strong> Because WarehousePG does not support scrollable cursors, the <code>RETRIEVE</code> command moves a parallel retrieve cursor only forward in position.</p></blockquote><p>When it is created, a parallel retrieve cursor is positioned before the first row. After retrieving some rows, the cursor is positioned on the row most recently retrieved.</p><p>If <code>RETRIEVE</code> runs off the end of the available rows then the cursor is left positioned after the last row.</p><p><code>RETRIEVE ALL</code> always leaves the parallel retrieve cursor positioned after the last row.</p><h2 id="parameters" tabindex="-1"><a id="section5"></a>Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to &quot;&lt;a id=&quot;section5&quot;&gt;&lt;/a&gt;Parameters&quot;">​</a></h2><p>count : Retrieve the next count number of rows. count must be a positive number.</p><p>ALL : Retrieve all remaining rows.</p><p>endpoint_name : The name of the endpoint from which to retrieve the rows.</p><h2 id="outputs" tabindex="-1"><a id="section5a"></a>Outputs <a class="header-anchor" href="#outputs" aria-label="Permalink to &quot;&lt;a id=&quot;section5a&quot;&gt;&lt;/a&gt;Outputs&quot;">​</a></h2><p>On successful completion, a <code>RETRIEVE</code> command returns the fetched rows (possibly empty) and a count of the number of rows fetched (possibly zero).</p><h2 id="notes" tabindex="-1"><a id="section6"></a>Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;&lt;a id=&quot;section6&quot;&gt;&lt;/a&gt;Notes&quot;">​</a></h2><p>Use <code>DECLARE ... PARALLEL RETRIEVE CURSOR</code> to define a parallel retrieve cursor.</p><p>Parallel retrieve cursors do not support <code>FETCH</code> or <code>MOVE</code> operations.</p><h2 id="examples" tabindex="-1"><a id="section7"></a>Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;&lt;a id=&quot;section7&quot;&gt;&lt;/a&gt;Examples&quot;">​</a></h2><p>Start the transaction:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>BEGIN;</span></span></code></pre></div><p>Create a parallel retrieve cursor:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DECLARE mycursor PARALLEL RETRIEVE CURSOR FOR SELECT * FROM films;</span></span></code></pre></div><p>List the cursor endpoints:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SELECT * FROM gp_endpoints WHERE cursorname=&#39;mycursor&#39;;</span></span></code></pre></div><p>Note the hostname, port, auth_token, and name associated with each endpoint.</p><p>In another terminal window, initiate a retrieve session using a hostname, port, and auth_token returned from the previous query. For example:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>PGPASSWORD=d3825fc07e56bee5fcd2b1d0b600c85e PGOPTIONS=&#39;-c gp_retrieve_conn=true&#39; psql -d testdb -h sdw3 -p 6001;</span></span></code></pre></div><p>Fetch all rows from an endpoint (for example, the endpoint named <code>prc10000001100000005</code>):</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>RETRIEVE ALL FROM ENDPOINT prc10000001100000005;</span></span></code></pre></div><p>Exit the retrieve session.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>\\q</span></span></code></pre></div><p>Back in the original session, close the cursor and end the transaction:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CLOSE mycursor;</span></span>
<span class="line"><span>COMMIT;</span></span></code></pre></div><h2 id="compatibility" tabindex="-1"><a id="section8"></a>Compatibility <a class="header-anchor" href="#compatibility" aria-label="Permalink to &quot;&lt;a id=&quot;section8&quot;&gt;&lt;/a&gt;Compatibility&quot;">​</a></h2><p><code>RETRIEVE</code> is a WarehousePG extension. The SQL standard makes no provisions for parallel retrieve cursors.</p><h2 id="see-also" tabindex="-1"><a id="section9"></a>See Also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;&lt;a id=&quot;section9&quot;&gt;&lt;/a&gt;See Also&quot;">​</a></h2><p><a href="./DECLARE.html">DECLARE</a>, <a href="./CLOSE.html">CLOSE</a></p><p><strong>Parent topic:</strong> <a href="./../sql_commands/sql_ref.html">SQL Commands</a></p>`,41)]))}const m=t(i,[["render",r]]);export{u as __pageData,m as default};
