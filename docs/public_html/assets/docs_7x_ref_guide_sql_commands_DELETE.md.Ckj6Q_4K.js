import{_ as a,c as t,o,ag as s}from"./chunks/framework.Ds6Eueu6.js";const u=JSON.parse('{"title":"DELETE","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/ref_guide/sql_commands/DELETE.md","filePath":"docs/7x/ref_guide/sql_commands/DELETE.md"}'),n={name:"docs/7x/ref_guide/sql_commands/DELETE.md"};function i(c,e,d,l,r,p){return o(),t("div",null,e[0]||(e[0]=[s(`<h1 id="delete" tabindex="-1">DELETE <a class="header-anchor" href="#delete" aria-label="Permalink to &quot;DELETE&quot;">​</a></h1><p>Deletes rows from a table.</p><h2 id="synopsis" tabindex="-1"><a id="section2"></a>Synopsis <a class="header-anchor" href="#synopsis" aria-label="Permalink to &quot;&lt;a id=&quot;section2&quot;&gt;&lt;/a&gt;Synopsis&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[ WITH [ RECURSIVE ] &lt;with_query&gt; [, ...] ]</span></span>
<span class="line"><span>DELETE FROM [ONLY] &lt;table_name&gt; [[AS] &lt;alias&gt;]</span></span>
<span class="line"><span>      [USING &lt;from_item&gt; [, ...] ]</span></span>
<span class="line"><span>      [WHERE &lt;condition&gt; | WHERE CURRENT OF &lt;cursor_name&gt;]</span></span>
<span class="line"><span>      [RETURNING * | &lt;output_expression&gt; [[AS] &lt;output_name&gt;] [, …]]</span></span></code></pre></div><h2 id="description" tabindex="-1"><a id="section3"></a>Description <a class="header-anchor" href="#description" aria-label="Permalink to &quot;&lt;a id=&quot;section3&quot;&gt;&lt;/a&gt;Description&quot;">​</a></h2><p><code>DELETE</code> deletes rows that satisfy the <code>WHERE</code> clause from the specified table. If the <code>WHERE</code> clause is absent, the effect is to delete all rows in the table. The result is a valid, but empty table.</p><p><strong>Tip:</strong> <a href="./TRUNCATE.html">TRUNCATE</a> provides a faster mechanism to remove all rows from a table.</p><p>There are two ways to delete rows in a table using information contained in other tables in the database: using sub-selects, or specifying additional tables in the <code>USING</code> clause. Which technique is more appropriate depends on the specific circumstances.</p><p>The optional <code>RETURNING</code> clause causes <code>DELETE</code> to compute and return value(s) based on each row actually deleted. Any expression using the table&#39;s columns, and/or columns of other tables mentioned in <code>USING</code>, can be computed. The syntax of the <code>RETURNING</code> list is identical to that of the output list of <code>SELECT</code>.</p><p>You must have the <code>DELETE</code> privilege on the table to delete from it, as well as the <code>SELECT</code> privilege for any table in the <code>USING</code> clause or whose values are read in the condition.</p><blockquote><p><strong>Note</strong> The <code>RETURNING</code> clause is not supported when deleting from append-optimized tables.</p></blockquote><blockquote><p><strong>Note</strong> As the default, WarehousePG acquires an <code>EXCLUSIVE</code> lock on tables for <code>DELETE</code> operations on heap tables. When the Global Deadlock Detector is enabled, the lock mode for <code>DELETE</code> operations on heap tables is <code>ROW EXCLUSIVE</code>. See <a href="./../../admin_guide/dml.html#topic_gdd">Global Deadlock Detector</a>.</p></blockquote><h2 id="parameters" tabindex="-1"><a id="section5"></a>Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to &quot;&lt;a id=&quot;section5&quot;&gt;&lt;/a&gt;Parameters&quot;">​</a></h2><p>with_query : The <code>WITH</code> clause allows you to specify one or more subqueries that can be referenced by name in the <code>DELETE</code> query.</p><p>: For a <code>DELETE</code> command that includes a <code>WITH</code> clause, the clause can only contain <code>SELECT</code> statements, the <code>WITH</code> clause cannot contain a data-modifying command (<code>INSERT</code>, <code>UPDATE</code>, or <code>DELETE</code>).</p><p>: See <a href="./../../admin_guide/query/topics/CTE-query.html#topic_zhs_r1s_w1b">WITH Queries (Common Table Expressions)</a> and <a href="./SELECT.html">SELECT</a> for details.</p><p>table_name : The name (optionally schema-qualified) of the table to delete rows from. If you specify <code>ONLY</code> before the table name, WarehousePG deletes matching rows from the named table only. If <code>ONLY</code> is not specified, matching rows are also deleted from any tables inheriting from the named table. Optionally, you can specify <code>*</code> after the table name to explicitly indicate that descendant tables are included.</p><p>alias : A substitute name for the target table. When an alias is provided, it completely hides the actual name of the table. For example, given <code>DELETE FROM foo AS f</code>, the remainder of the <code>DELETE</code> statement must refer to this table as <code>f</code> not <code>foo</code>.</p><p>from_item : A table expression allowing columns from other tables to appear in the <code>WHERE</code> condition. This uses the same syntax as the <code>FROM</code> clause of a <a href="./SELECT.html">SELECT</a> statement; for example, you can specify an alias for the table name. Do not repeat the target table in the from_item, unless you wish to set up a self-join (in which case it must appear with an alias in the from_item).</p><p>condition : An expression that returns a value of type <code>boolean</code>. WarehousePG deletes only those rows for which this expression returns <code>true</code>.</p><p>cursor_name : The name of the cursor to use in a <code>WHERE CURRENT OF</code> condition. The row to be deleted is the one most recently fetched from this cursor. The cursor must be a non-grouping query on the <code>DELETE</code>&#39;s target table. Note that <code>WHERE CURRENT OF</code> cannot be specified together with a Boolean condition. See <a href="./DECLARE.html">DECLARE</a> for more information about using cursors with <code>WHERE CURRENT OF</code>.</p><p>: The <code>DELETE...WHERE CURRENT OF</code> cursor statement can only be run on the server, for example in an interactive psql session or a script. Language extensions such as PL/pgSQL do not have support for updatable cursors.</p><p>output_expression : An expression to be computed and returned by the <code>DELETE</code> command after each row is deleted. The expression can use any column names of the table named by table_name or table(s) listed in <code>USING</code>. Write <code>*</code> to return all columns.</p><p>output_name : A name to use for a returned column.</p><h2 id="outputs" tabindex="-1"><a id="section4"></a>Outputs <a class="header-anchor" href="#outputs" aria-label="Permalink to &quot;&lt;a id=&quot;section4&quot;&gt;&lt;/a&gt;Outputs&quot;">​</a></h2><p>On successful completion, a <code>DELETE</code> command returns a command tag of the form</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DELETE &lt;count&gt;</span></span></code></pre></div><p>The count is the number of rows deleted. If count is 0, no rows were deleted by the query (this is not considered an error).</p><p>If the <code>DELETE</code> command contains a <code>RETURNING</code> clause, the result will be similar to that of a <code>SELECT</code> statement containing the columns and values defined in the <code>RETURNING</code> list, computed over the row(s) deleted by the command.</p><h2 id="notes" tabindex="-1"><a id="section6"></a>Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;&lt;a id=&quot;section6&quot;&gt;&lt;/a&gt;Notes&quot;">​</a></h2><p>The <code>RETURNING</code> clause is not supported when deleting from append-optimized tables.</p><p>The <code>WHERE CURRENT OF</code> clause is not supported with replicated tables.</p><p>WarehousePG lets you reference columns of other tables in the <code>WHERE</code> condition by specifying the other tables in the <code>USING</code> clause. For example, to delete all films produced by a given producer, one can run:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DELETE FROM films USING producers</span></span>
<span class="line"><span>  WHERE producer_id = producers.id AND producers.name = &#39;foo&#39;;</span></span></code></pre></div><p>What is essentially happening here is a join between <code>films</code> and <code>producers</code>, with all successfully joined <code>films</code> rows being marked for deletion. This syntax is not standard. A more standard way to accomplish this is:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DELETE FROM films</span></span>
<span class="line"><span>  WHERE producer_id IN (SELECT id FROM producers WHERE name = &#39;foo&#39;);</span></span></code></pre></div><p>For a partitioned table, all of the child tables are locked during the <code>DELETE</code> operation when the Global Deadlock Detector is not enabled (the default). Only some of the leaf child tables are locked when the Global Deadlock Detector is enabled. For information about the Global Deadlock Detector, see <a href="./../../admin_guide/dml.html#topic_gdd">Global Deadlock Detector</a>.</p><h2 id="examples" tabindex="-1"><a id="section7"></a>Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;&lt;a id=&quot;section7&quot;&gt;&lt;/a&gt;Examples&quot;">​</a></h2><p>Delete all films but musicals:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DELETE FROM films WHERE kind &lt;&gt; &#39;Musical&#39;;</span></span></code></pre></div><p>Clear the table films:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DELETE FROM films;</span></span></code></pre></div><p>Delete completed tasks, returning full details of the deleted rows:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DELETE FROM tasks WHERE status = &#39;DONE&#39; RETURNING *;</span></span></code></pre></div><p>Delete the row of tasks on which the cursor <code>c_tasks</code> is currently positioned:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DELETE FROM tasks WHERE CURRENT OF c_tasks;</span></span></code></pre></div><p>Delete using a join:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DELETE FROM rank USING names WHERE names.id = rank.id AND </span></span>
<span class="line"><span>name = &#39;Hannah&#39;;</span></span></code></pre></div><h2 id="compatibility" tabindex="-1"><a id="section8"></a>Compatibility <a class="header-anchor" href="#compatibility" aria-label="Permalink to &quot;&lt;a id=&quot;section8&quot;&gt;&lt;/a&gt;Compatibility&quot;">​</a></h2><p>This command conforms to the SQL standard, except that the <code>USING</code> and <code>RETURNING</code> clauses are WarehousePG extensions, as is the ability to use <code>WITH</code> with <code>DELETE</code>.</p><h2 id="see-also" tabindex="-1"><a id="section9"></a>See Also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;&lt;a id=&quot;section9&quot;&gt;&lt;/a&gt;See Also&quot;">​</a></h2><p><a href="./TRUNCATE.html">TRUNCATE</a></p><p><strong>Parent topic:</strong> <a href="./../sql_commands/sql_ref.html">SQL Commands</a></p>`,53)]))}const m=a(n,[["render",i]]);export{u as __pageData,m as default};
