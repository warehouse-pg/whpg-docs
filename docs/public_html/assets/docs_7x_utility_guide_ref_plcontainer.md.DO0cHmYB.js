import{_ as n,c as t,o as i,ag as a}from"./chunks/framework.Ds6Eueu6.js";const m=JSON.parse('{"title":"plcontainer","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/utility_guide/ref/plcontainer.md","filePath":"docs/7x/utility_guide/ref/plcontainer.md"}'),o={name:"docs/7x/utility_guide/ref/plcontainer.md"};function s(r,e,l,p,c,d){return i(),t("div",null,e[0]||(e[0]=[a(`<h1 id="plcontainer" tabindex="-1">plcontainer <a class="header-anchor" href="#plcontainer" aria-label="Permalink to &quot;plcontainer&quot;">​</a></h1><p>The <code>plcontainer</code> utility installs Docker images and manages the PL/Container configuration. The utility consists of two sets of commands.</p><ul><li><code>image-*</code> commands manage Docker images on the WarehousePG cluster hosts.</li><li><code>runtime-*</code> commands manage the PL/Container configuration file on the WarehousePG instances. You can add Docker image information to the PL/Container configuration file including the image name, location, and shared folder information. You can also edit the configuration file.</li></ul><p>To configure PL/Container to use a Docker image, you install the Docker image on all the WarehousePG hosts and then add configuration information to the PL/Container configuration.</p><p>PL/Container configuration values, such as image names, runtime IDs, and parameter values and names are case sensitive.</p><h2 id="plcontainer-syntax" tabindex="-1"><a id="synt"></a>plcontainer Syntax <a class="header-anchor" href="#plcontainer-syntax" aria-label="Permalink to &quot;&lt;a id=&quot;synt&quot;&gt;&lt;/a&gt;plcontainer Syntax&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>plcontainer [&lt;command&gt;] [-h | --help]  [--verbose]</span></span></code></pre></div><p>Where &lt;command&gt; is one of the following.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  image-add {{-f | --file} &lt;image_file&gt; [-ulc | --use_local_copy]} | {{-u | --URL} &lt;image_URL&gt;}</span></span>
<span class="line"><span>  image-delete {-i | --image} &lt;image_name&gt;</span></span>
<span class="line"><span>  image-list</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  runtime-add {-r | --runtime} &lt;runtime_id&gt;</span></span>
<span class="line"><span>     {-i | --image} &lt;image_name&gt; {-l | --language} {python | python3 | r}</span></span>
<span class="line"><span>     [{-v | --volume} &lt;shared_volume&gt; [{-v| --volume} &lt;shared_volume&gt;...]]</span></span>
<span class="line"><span>     [{-s | --setting} &lt;param=value&gt; [{-s | --setting} &lt;param=value&gt; ...]]</span></span>
<span class="line"><span>  runtime-replace {-r | --runtime} &lt;runtime_id&gt;</span></span>
<span class="line"><span>     {-i | --image} &lt;image_name&gt; -l {r | python}</span></span>
<span class="line"><span>     [{-v | --volume} &lt;shared_volume&gt; [{-v | --volume} &lt;shared_volume&gt;...]]</span></span>
<span class="line"><span>     [{-s | --setting} &lt;param=value&gt; [{-s | --setting} &lt;param=value&gt; ...]]</span></span>
<span class="line"><span>  runtime-show {-r | --runtime} &lt;runtime_id&gt;</span></span>
<span class="line"><span>  runtime-delete {-r | --runtime} &lt;runtime_id&gt;</span></span>
<span class="line"><span>  runtime-edit [{-e | --editor} &lt;editor&gt;]</span></span>
<span class="line"><span>  runtime-backup {-f | --file} &lt;config_file&gt;</span></span>
<span class="line"><span>  runtime-restore {-f | --file} &lt;config_file&gt;</span></span>
<span class="line"><span>  runtime-verify</span></span></code></pre></div><h2 id="plcontainer-commands-and-options" tabindex="-1"><a id="cmds"></a>plcontainer Commands and Options <a class="header-anchor" href="#plcontainer-commands-and-options" aria-label="Permalink to &quot;&lt;a id=&quot;cmds&quot;&gt;&lt;/a&gt;plcontainer Commands and Options&quot;">​</a></h2><p>image-add location : Install a Docker image on the WarehousePG hosts. Specify either the location of the Docker image file on the host or the URL to the Docker image. These are the supported location options:</p><pre><code>-   \\{**-f** \\| **--file**\\} image\\_file Specify the file system location of the Docker image tar archive file on the local host. This example specifies an image file in the \`gpadmin\` user&#39;s home directory: \`/home/gpadmin/test_image.tar.gz\`
-   \\{**-u** \\| **--URL**\\} image\\_URL Specify the URL of the Docker repository and image. This example URL points to a local Docker repository \`192.168.0.1:5000/images/mytest_plc_r:devel\`
</code></pre><p>: By default, the <code>image-add</code> command copies the image to each WarehousePG segment and standby coordinator host, and installs the image. When you specify an image_file and provide the [<strong>-ulc</strong> | <strong>--use_local_copy</strong>] option, <code>plcontainer</code> installs the image only on the host on which you run the command.</p><p>: After installing the Docker image, use the <a href="#runtime_add">runtime-add</a> command to configure PL/Container to use the Docker image.</p><p>image-delete {<strong>-i</strong> | <strong>--image</strong>} image_name : Remove an installed Docker image from all WarehousePG hosts. Specify the full Docker image name including the tag for example <code>pivotaldata/plcontainer_python_shared:1.0.0</code></p><p>image-list : List the Docker images installed on the host. The command list only the images on the local host, not remote hosts. The command lists all installed Docker images, including images installed with Docker commands.</p><p>runtime-add options : Add configuration information to the PL/Container configuration file on all WarehousePG hosts. If the specified runtime_id exists, the utility returns an error and the configuration information is not added.</p><p>: These are the supported options:</p><p>: {<strong>-i</strong> | <strong>--image</strong>} docker-image : Required. Specify the full Docker image name, including the tag, that is installed on the WarehousePG hosts. For example <code>pivotaldata/plcontainer_python:1.0.0</code>.</p><p>: The utility returns a warning if the specified Docker image is not installed.</p><p>: The <code>plcontainer image-list</code> command displays installed image information including the name and tag (the Repository and Tag columns).</p><p>{<strong>-l</strong> | <strong>--language</strong>} python | python3 | r : Required. Specify the PL/Container language type, supported values are <code>python</code> (PL/Python using Python 2), <code>python3</code> (PL/Python using Python 3) and <code>r</code> (PL/R). When adding configuration information for a new runtime, the utility adds a startup command to the configuration based on the language you specify.</p><p>: Startup command for the Python 2 language.</p><pre><code>\`\`\`
/clientdir/pyclient.sh
\`\`\`
</code></pre><p>: Startup command for the Python 3 language.</p><pre><code>\`\`\`
/clientdir/pyclient3.sh
\`\`\`
</code></pre><p>: Startup command for the R language.</p><pre><code>\`\`\`
/clientdir/rclient.sh
\`\`\`
</code></pre><p>{<strong>-r</strong> | <strong>--runtime</strong>} runtime_id : Required. Add the runtime ID. When adding a <code>runtime</code> element in the PL/Container configuration file, this is the value of the <code>id</code> element in the PL/Container configuration file. Maximum length is 63 Bytes.</p><p>: You specify the name in the WarehousePG UDF on the <code># container</code> line.</p><p>{<strong>-s</strong> | <strong>--setting</strong>} param=value : Optional. Specify a setting to add to the runtime configuration information. You can specify this option multiple times. The setting applies to the runtime configuration specified by the runtime_id. The parameter is the XML attribute of the <a href="#plc_settings">settings</a> element in the PL/Container configuration file. These are valid parameters.</p><pre><code>-   \`cpu_share\` - Set the CPU limit for each container in the runtime configuration. The default value is 1024. The value is a relative weighting of CPU usage compared to other containers.
-   \`memory_mb\` - Set the memory limit for each container in the runtime configuration. The default value is 1024. The value is an integer that specifies the amount of memory in MB.
-   \`resource_group_id\` - Assign the specified resource group to the runtime configuration. The resource group limits the total CPU and memory resource usage for all containers that share this runtime configuration. You must specify the \`groupid\` of the resource group. For information about managing PL/Container resources, see [About PL/Container Resource Management](#topic_resmgmt).
-   \`roles\` - Specify the WarehousePG roles that are allowed to run a container for the runtime configuration. You can specify a single role name or comma separated lists of role names. The default is no restriction.
-   \`use_container_logging\` - Enable or deactivate Docker logging for the container. The value is either \`yes\` \\(activate logging\\) or \`no\` \\(deactivate logging, the default\\).
&lt;br/&gt;&lt;br/&gt;The WarehousePG server configuration parameter [log\\_min\\_messages](../../ref_guide/config_params/guc-list.html) controls the log level. The default log level is \`warning\`. For information about PL/Container log information, see [Notes](#plc_notes).
</code></pre><p>{<strong>-v</strong> | <strong>--volume</strong>} shared-volume : Optional. Specify a Docker volume to bind mount. You can specify this option multiple times to define multiple volumes.</p><p>: The format for a shared volume: <code>host-dir:container-dir:[rw|ro]</code>. The information is stored as attributes in the <code>shared_directory</code> element of the <code>runtime</code> element in the PL/Container configuration file.</p><pre><code>-   host-dir - absolute path to a directory on the host system. The WarehousePG administrator user \\(gpadmin\\) must have appropriate access to the directory.
-   container-dir - absolute path to a directory in the Docker container.
-   \`[rw|ro]\` - read-write or read-only access to the host directory from the container.
</code></pre><p>: When adding configuration information for a new runtime, the utility adds this read-only shared volume information.</p><p>: <code>&lt;greenplum-home&gt;/bin/plcontainer_clients:/clientdir:ro</code></p><p>: If needed, you can specify other shared directories. The utility returns an error if the specified container-dir is the same as the one that is added by the utility, or if you specify multiple shared volumes with the same container-dir.</p><pre><code>&gt; **Caution** Allowing read-write access to a host directory requires special considerations.

-   When specifying read-write access to host directory, ensure that the specified host directory has the correct permissions.
-   When running PL/Container user-defined functions, multiple concurrent Docker containers that are running on a host could change data in the host directory. Ensure that the functions support multiple concurrent access to the data in the host directory.
</code></pre><p>runtime-backup {<strong>-f</strong> | <strong>--file</strong>} config_file : Copies the PL/Container configuration file to the specified file on the local host.</p><p>runtime-delete {<strong>-r</strong> | <strong>--runtime</strong>} runtime_id : Removes runtime configuration information in the PL/Container configuration file on all WarehousePG instances. The utility returns a message if the specified runtime_id does not exist in the file.</p><p>runtime-edit [{<strong>-e</strong> | <strong>--editor</strong>} editor] : Edit the XML file <code>plcontainer_configuration.xml</code> with the specified editor. The default editor is <code>vi</code>.</p><pre><code>Saving the file updates the configuration file on all WarehousePG hosts. If errors exist in the updated file, the utility returns an error and does not update the file.
</code></pre><p>runtime-replace options : Replaces runtime configuration information in the PL/Container configuration file on all WarehousePG instances. If the runtime_id does not exist, the information is added to the configuration file. The utility adds a startup command and shared directory to the configuration.</p><pre><code>See [runtime-add](#runtime_add) for command options and information added to the configuration.
</code></pre><p>runtime-restore {<strong>-f</strong> | <strong>--file</strong>} config_file : Replaces information in the PL/Container configuration file <code>plcontainer_configuration.xml</code> on all WarehousePG instances with the information from the specified file on the local host.</p><p>runtime-show [{<strong>-r</strong> | <strong>--runtime</strong>} runtime_id] : Displays formatted PL/Container runtime configuration information. If a runtime_id is not specified, the configuration for all runtime IDs are displayed.</p><p>runtime-verify : Checks the PL/Container configuration information on the WarehousePG instances with the configuration information on the coordinator. If the utility finds inconsistencies, you are prompted to replace the remote copy with the local copy. The utility also performs XML validation.</p><p><strong>-h</strong> | <strong>--help</strong> : Display help text. If specified without a command, displays help for all <code>plcontainer</code> commands. If specified with a command, displays help for the command.</p><p><strong>--verbose</strong> : Enable verbose logging for the command.</p><h2 id="examples" tabindex="-1"><a id="exs"></a>Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;&lt;a id=&quot;exs&quot;&gt;&lt;/a&gt;Examples&quot;">​</a></h2><p>These are examples of common commands to manage PL/Container:</p><ul><li><p>Install a Docker image on all WarehousePG hosts. This example loads a Docker image from a file. The utility displays progress information on the command line as the utility installs the Docker image on all the hosts.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>plcontainer image-add -f plc_newr.tar.gz</span></span></code></pre></div><p>After installing the Docker image, you add or update a runtime entry in the PL/Container configuration file to give PL/Container access to the Docker image to start Docker containers.</p></li><li><p>Install the Docker image only on the local WarehousePG host:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>plcontainer image-add -f /home/gpadmin/plc_python_image.tar.gz --use_local_copy</span></span></code></pre></div></li><li><p>Add a container entry to the PL/Container configuration file. This example adds configuration information for a PL/R runtime, and specifies a shared volume and settings for memory and logging.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>plcontainer runtime-add -r runtime2 -i test_image2:0.1 -l r \\</span></span>
<span class="line"><span>  -v /host_dir2/shared2:/container_dir2/shared2:ro \\</span></span>
<span class="line"><span>  -s memory_mb=512 -s use_container_logging=yes</span></span></code></pre></div><p>The utility displays progress information on the command line as it adds the runtime configuration to the configuration file and distributes the updated configuration to all instances.</p></li><li><p>Show specific runtime with given runtime id in configuration file</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>plcontainer runtime-show -r plc_python_shared</span></span></code></pre></div><p>The utility displays the configuration information similar to this output.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>PL/Container Runtime Configuration:</span></span>
<span class="line"><span>---------------------------------------------------------</span></span>
<span class="line"><span> Runtime ID: plc_python_shared</span></span>
<span class="line"><span> Linked Docker Image: test1:latest</span></span>
<span class="line"><span> Runtime Setting(s):</span></span>
<span class="line"><span> Shared Directory:</span></span>
<span class="line"><span> ---- Shared Directory From HOST &#39;/usr/local/greenplum-db/bin/plcontainer_clients&#39; to Container &#39;/clientdir&#39;, access mode is &#39;ro&#39;</span></span>
<span class="line"><span> ---- Shared Directory From HOST &#39;/home/gpadmin/share/&#39; to Container &#39;/opt/share&#39;, access mode is &#39;rw&#39;</span></span>
<span class="line"><span>---------------------------------------------------------</span></span></code></pre></div></li><li><p>Edit the configuration in an interactive editor of your choice. This example edits the configuration file with the vim editor.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>plcontainer runtime-edit -e vim</span></span></code></pre></div><p>When you save the file, the utility displays progress information on the command line as it distributes the file to the WarehousePG hosts.</p></li><li><p>Save the current PL/Container configuration to a file. This example saves the file to the local file <code>/home/gpadmin/saved_plc_config.xml</code></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>plcontainer runtime-backup -f /home/gpadmin/saved_plc_config.xml</span></span></code></pre></div></li><li><p>Overwrite PL/Container configuration file with an XML file. This example replaces the information in the configuration file with the information from the file in the <code>/home/gpadmin</code> directory.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>plcontainer runtime-restore -f /home/gpadmin/new_plcontainer_configuration.xml</span></span></code></pre></div><p>The utility displays progress information on the command line as it distributes the updated file to the WarehousePG instances.</p></li></ul>`,53)]))}const u=n(o,[["render",s]]);export{m as __pageData,u as default};
