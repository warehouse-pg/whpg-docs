import{_ as t,c as a,o,ag as i}from"./chunks/framework.Ds6Eueu6.js";const m=JSON.parse('{"title":"System Monitoring and Maintenance","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/best_practices/maintenance.md","filePath":"docs/7x/best_practices/maintenance.md"}'),n={name:"docs/7x/best_practices/maintenance.md"};function s(r,e,c,d,l,h){return o(),a("div",null,e[0]||(e[0]=[i('<h1 id="system-monitoring-and-maintenance" tabindex="-1">System Monitoring and Maintenance <a class="header-anchor" href="#system-monitoring-and-maintenance" aria-label="Permalink to &quot;System Monitoring and Maintenance&quot;">​</a></h1><hr><p>Best practices for regular maintenance that will ensure WarehousePG high availability and optimal performance.</p><ul><li><p><strong><a href="./analyze.html">Updating Statistics with ANALYZE</a></strong></p></li><li><p><strong><a href="./bloat.html">Managing Bloat in a Database</a></strong></p></li><li><p><strong><a href="./logfiles.html">Monitoring WarehousePG Log Files</a></strong></p></li></ul><p><strong>Parent topic:</strong> <a href="./intro.html">WarehousePG Best Practices</a></p><h2 id="monitoring" tabindex="-1"><a id="topic_izw_bwb_s4"></a>Monitoring <a class="header-anchor" href="#monitoring" aria-label="Permalink to &quot;&lt;a id=&quot;topic_izw_bwb_s4&quot;&gt;&lt;/a&gt;Monitoring&quot;">​</a></h2><p>WarehousePG includes utilities that are useful for monitoring the system.</p><p>The <code>gp_toolkit</code> schema contains several views that can be accessed using SQL commands to query system catalogs, log files, and operating environment for system status information.</p><p>The <code>gp_stats_missing</code> view shows tables that do not have statistics and require <code>ANALYZE</code> to be run.</p><p>For additional information on <code>gpstate</code> and <code>gpcheckperf</code> refer to the <em>WarehousePG Utility Guide</em>. For information about the <code>gp_toolkit</code> schema, see the <em>WarehousePG Reference Guide</em>.</p><h3 id="gpstate" tabindex="-1"><a id="gpstate"></a>gpstate <a class="header-anchor" href="#gpstate" aria-label="Permalink to &quot;&lt;a id=&quot;gpstate&quot;&gt;&lt;/a&gt;gpstate&quot;">​</a></h3><p>The <code>gpstate</code> utility program displays the status of the WarehousePG cluster, including which segments are down, coordinator and segment configuration information (hosts, data directories, etc.), the ports used by the system, and mapping of primary segments to their corresponding mirror segments.</p><p>Run <code>gpstate -Q</code> to get a list of segments that are marked &quot;down&quot; in the coordinator system catalog.</p><p>To get detailed status information for the WarehousePG cluster, run <code>gpstate -s</code>.</p><h3 id="gpcheckperf" tabindex="-1"><a id="gpcheckperf"></a>gpcheckperf <a class="header-anchor" href="#gpcheckperf" aria-label="Permalink to &quot;&lt;a id=&quot;gpcheckperf&quot;&gt;&lt;/a&gt;gpcheckperf&quot;">​</a></h3><p>The <code>gpcheckperf</code> utility tests baseline hardware performance for a list of hosts. The results can help identify hardware issues. It performs the following checks:</p><ul><li>disk I/O test – measures I/O performance by writing and reading a large file using the <code>dd</code> operating system command. It reports read and write rates in megabytes per second.</li><li>memory bandwidth test – measures sustainable memory bandwidth in megabytes per second using the STREAM benchmark.</li><li>network performance test – runs the <code>gpnetbench</code> network benchmark program (optionally <code>netperf)</code> to test network performance. The test is run in one of three modes: parallel pair test (<code>-r N</code>), serial pair test (<code>-r n</code>), or full-matrix test (<code>-r M)</code>. The minimum, maximum, average, and median transfer rates are reported in megabytes per second.</li></ul><p>To obtain valid numbers from <code>gpcheckperf</code>, the database system must be stopped. The numbers from <code>gpcheckperf</code> can be inaccurate even if the system is up and running with no query activity.</p><p><code>gpcheckperf</code> requires a trusted host setup between the hosts involved in the performance test. It calls <code>gpssh</code> and <code>gpsync</code>, so these utilities must also be in your <code>PATH</code>. Specify the hosts to check individually (<code>-h *host1* -h *host2* ...</code>) or with <code>-f *hosts_file*</code>, where <code>*hosts_file*</code> is a text file containing a list of the hosts to check. If you have more than one subnet, create a separate host file for each subnet so that you can test the subnets separately.</p><p>By default, <code>gpcheckperf</code> runs the disk I/O test, the memory test, and a serial pair network performance test. With the disk I/O test, you must use the <code>-d</code> option to specify the file systems you want to test. The following command tests disk I/O and memory bandwidth on hosts listed in the <code>subnet_1_hosts</code> file:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ gpcheckperf -f subnet_1_hosts -d /data1 -d /data2 -r ds</span></span></code></pre></div><p>The <code>-r</code> option selects the tests to run: disk I/O (<code>d</code>), memory bandwidth (<code>s</code>), network parallel pair (<code>N</code>), network serial pair test (<code>n</code>), network full-matrix test (<code>M</code>). Only one network mode can be selected per execution. See the <em>WarehousePG Reference Guide</em> for the detailed <code>gpcheckperf</code> reference.</p><h3 id="monitoring-with-operating-system-utilities" tabindex="-1"><a id="monos"></a>Monitoring with Operating System Utilities <a class="header-anchor" href="#monitoring-with-operating-system-utilities" aria-label="Permalink to &quot;&lt;a id=&quot;monos&quot;&gt;&lt;/a&gt;Monitoring with Operating System Utilities&quot;">​</a></h3><p>The following Linux/UNIX utilities can be used to assess host performance:</p><ul><li><code>iostat</code> allows you to monitor disk activity on segment hosts.</li><li><code>top</code> displays a dynamic view of operating system processes.</li><li><code>vmstat</code> displays memory usage statistics.</li></ul><p>You can use <code>gpssh</code> to run utilities on multiple hosts.</p><h3 id="best-practices" tabindex="-1"><a id="bp1"></a>Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;&lt;a id=&quot;bp1&quot;&gt;&lt;/a&gt;Best Practices&quot;">​</a></h3><ul><li>Implement the &quot;Recommended Monitoring and Maintenance Tasks&quot; in the <em>WarehousePG Administrator Guide</em>.</li><li>Run <code>gpcheckperf</code> at install time and periodically thereafter, saving the output to compare system performance over time.</li><li>Use all the tools at your disposal to understand how your system behaves under different loads.</li><li>Examine any unusual event to determine the cause.</li><li>Monitor query activity on the system by running explain plans periodically to ensure the queries are running optimally.</li><li>Review plans to determine whether index are being used and partition elimination is occurring as expected.</li></ul><h3 id="additional-information" tabindex="-1"><a id="addinfo"></a>Additional Information <a class="header-anchor" href="#additional-information" aria-label="Permalink to &quot;&lt;a id=&quot;addinfo&quot;&gt;&lt;/a&gt;Additional Information&quot;">​</a></h3><ul><li><code>gpcheckperf</code> reference in the <em>WarehousePG Utility Guide</em>.</li><li>&quot;Recommended Monitoring and Maintenance Tasks&quot; in the <em>WarehousePG Administrator Guide</em>.</li><li><a href="http://www.cs.virginia.edu/%7Emccalpin/papers/bandwidth/bandwidth.html" target="_blank" rel="noreferrer">Sustainable Memory Bandwidth in Current High Performance Computers</a>. John D. McCalpin. Oct 12, 1995.</li><li><a href="http://www.netperf.org/netperf" target="_blank" rel="noreferrer">www.netperf.org</a> to use <code>netperf</code>, netperf must be installed on each host you test. See <code>gpcheckperf</code> reference for more information.</li></ul>',30)]))}const u=t(n,[["render",s]]);export{m as __pageData,u as default};
