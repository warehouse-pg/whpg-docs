import{_ as s,c as e,o as n,ag as t}from"./chunks/framework.Ds6Eueu6.js";const m=JSON.parse('{"title":"CREATE STATISTICS","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/ref_guide/sql_commands/CREATE_STATISTICS.md","filePath":"docs/7x/ref_guide/sql_commands/CREATE_STATISTICS.md"}'),i={name:"docs/7x/ref_guide/sql_commands/CREATE_STATISTICS.md"};function o(p,a,c,l,d,r){return n(),e("div",null,a[0]||(a[0]=[t(`<h1 id="create-statistics" tabindex="-1">CREATE STATISTICS <a class="header-anchor" href="#create-statistics" aria-label="Permalink to &quot;CREATE STATISTICS&quot;">​</a></h1><p>Defines extended statistics.</p><h2 id="synopsis" tabindex="-1"><a id="section2"></a>Synopsis <a class="header-anchor" href="#synopsis" aria-label="Permalink to &quot;&lt;a id=&quot;section2&quot;&gt;&lt;/a&gt;Synopsis&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE STATISTICS [ IF NOT EXISTS ] &lt;statistics_name&gt;</span></span>
<span class="line"><span>    [ ( &lt;statistics_kind&gt; [, ... ] ) ]</span></span>
<span class="line"><span>    ON &lt;column_name&gt;, &lt;column_name&gt; [, ...]</span></span>
<span class="line"><span>    FROM &lt;table_name&gt;</span></span></code></pre></div><h2 id="description" tabindex="-1"><a id="section3"></a>Description <a class="header-anchor" href="#description" aria-label="Permalink to &quot;&lt;a id=&quot;section3&quot;&gt;&lt;/a&gt;Description&quot;">​</a></h2><p><code>CREATE STATISTICS</code> creates a new extended statistics object tracking data about the specified table, foreign table, or materialized view. The statistics object is created in the current database and will be owned by the user issuing the command.</p><p>If a schema name is given (for example, <code>CREATE STATISTICS myschema.mystat ...</code>) then the statistics object is created in the specified schema. Otherwise it is created in the current schema. The name of the statistics object must be distinct from the name of any other statistics object in the same schema.</p><h2 id="parameters" tabindex="-1"><a id="section4"></a>Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to &quot;&lt;a id=&quot;section4&quot;&gt;&lt;/a&gt;Parameters&quot;">​</a></h2><p>IF NOT EXISTS</p><p>: Do not throw an error if a statistics object with the same name already exists. WarehousePG issues a notice in this case. Note that only the name of the statistics object is considered here, not the details of its definition.</p><p>statistics_name : The name (optionally schema-qualified) of the statistics object to create.</p><p>statistics_kind : A statistics kind to be computed in this statistics object. Currently supported kinds are <code>ndistinct</code>, which enables n-distinct statistics, <code>dependencies</code>, which enables functional dependency statistics, and <code>mcv</code> which enables most-common values lists. If this clause is omitted, all supported statistics kinds are included in the statistics object.</p><p>column_name : The name of a table column to be covered by the computed statistics. You must specify at least two column names; the order of the column names is insignificant.</p><p>table_name : The name (optionally schema-qualified) of the table containing the column(s) on which the statistics are computed; see <a href="./ANALYZE.html">ANALYZE</a> for an explanation of inheritance and partition handling.</p><h2 id="notes" tabindex="-1"><a id="section5"></a>Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;&lt;a id=&quot;section5&quot;&gt;&lt;/a&gt;Notes&quot;">​</a></h2><p>You must be the owner of a table to create a statistics object that reads it. Once created, however, the ownership of the statistics object is independent of the underlying table(s).</p><h2 id="examples" tabindex="-1"><a id="section6"></a>Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;&lt;a id=&quot;section6&quot;&gt;&lt;/a&gt;Examples&quot;">​</a></h2><p>Create table <code>t1</code> with two functionally-dependent columns, i.e., knowledge of a value in the first column is sufficient for determining the value in the other column. Then build functional dependency statistics on those columns:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE TABLE t1 (</span></span>
<span class="line"><span>    a   int,</span></span>
<span class="line"><span>    b   int</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>INSERT INTO t1 SELECT i/100, i/500</span></span>
<span class="line"><span>                 FROM generate_series(1,1000000) s(i);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ANALYZE t1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- the number of matching rows will be drastically underestimated:</span></span>
<span class="line"><span>EXPLAIN ANALYZE SELECT * FROM t1 WHERE (a = 1) AND (b = 0);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE STATISTICS s1 (dependencies) ON a, b FROM t1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ANALYZE t1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- now the row count estimate is more accurate:</span></span>
<span class="line"><span>EXPLAIN ANALYZE SELECT * FROM t1 WHERE (a = 1) AND (b = 0);</span></span></code></pre></div><p>Without functional-dependency statistics, the planner assumes that the two <code>WHERE</code> conditions are independent, and would multiply their selectivities together to arrive at a much-too-small row count estimate. With such statistics, the planner recognizes that the <code>WHERE</code> conditions are redundant and does not underestimate the row count.</p><p>Create table <code>t2</code> with two perfectly correlated columns (containing identical data), and a MCV list on those columns:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE TABLE t2 (</span></span>
<span class="line"><span>    a   int,</span></span>
<span class="line"><span>    b   int</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>INSERT INTO t2 SELECT mod(i,100), mod(i,100)</span></span>
<span class="line"><span>                 FROM generate_series(1,1000000) s(i);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE STATISTICS s2 (mcv) ON a, b FROM t2;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ANALYZE t2;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- valid combination (found in MCV)</span></span>
<span class="line"><span>EXPLAIN ANALYZE SELECT * FROM t2 WHERE (a = 1) AND (b = 1);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- invalid combination (not found in MCV)</span></span>
<span class="line"><span>EXPLAIN ANALYZE SELECT * FROM t2 WHERE (a = 1) AND (b = 2);</span></span></code></pre></div><p>The MCV list gives the planner more detailed information about the specific values that commonly appear in the table, as well as an upper bound on the selectivities of combinations of values that do not appear in the table, allowing it to generate better estimates in both cases.</p><h2 id="compatibility" tabindex="-1"><a id="section7"></a>Compatibility <a class="header-anchor" href="#compatibility" aria-label="Permalink to &quot;&lt;a id=&quot;section7&quot;&gt;&lt;/a&gt;Compatibility&quot;">​</a></h2><p>There is no <code>CREATE STATISTICS</code> statement in the SQL standard.</p><h2 id="see-also" tabindex="-1"><a id="section8"></a>See Also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;&lt;a id=&quot;section8&quot;&gt;&lt;/a&gt;See Also&quot;">​</a></h2><p><a href="./ALTER_STATISTICS.html">ALTER STATISTICS</a>, <a href="./DROP_STATISTICS.html">DROP STATISTICS</a></p><p><strong>Parent topic:</strong> <a href="./../sql_commands/sql_ref.html">SQL Commands</a></p>`,28)]))}const u=s(i,[["render",o]]);export{m as __pageData,u as default};
