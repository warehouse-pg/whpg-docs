import{_ as e,c as s,o as t,ag as n}from"./chunks/framework.Ds6Eueu6.js";const u=JSON.parse('{"title":"ROLLBACK TO SAVEPOINT","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/ref_guide/sql_commands/ROLLBACK_TO_SAVEPOINT.md","filePath":"docs/7x/ref_guide/sql_commands/ROLLBACK_TO_SAVEPOINT.md"}'),o={name:"docs/7x/ref_guide/sql_commands/ROLLBACK_TO_SAVEPOINT.md"};function i(l,a,p,c,r,d){return t(),s("div",null,a[0]||(a[0]=[n(`<h1 id="rollback-to-savepoint" tabindex="-1">ROLLBACK TO SAVEPOINT <a class="header-anchor" href="#rollback-to-savepoint" aria-label="Permalink to &quot;ROLLBACK TO SAVEPOINT&quot;">​</a></h1><p>Rolls back the current transaction to a savepoint.</p><h2 id="synopsis" tabindex="-1"><a id="section2"></a>Synopsis <a class="header-anchor" href="#synopsis" aria-label="Permalink to &quot;&lt;a id=&quot;section2&quot;&gt;&lt;/a&gt;Synopsis&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ROLLBACK [ WORK | TRANSACTION ] TO [ SAVEPOINT ] &lt;savepoint_name&gt;</span></span></code></pre></div><h2 id="description" tabindex="-1"><a id="section3"></a>Description <a class="header-anchor" href="#description" aria-label="Permalink to &quot;&lt;a id=&quot;section3&quot;&gt;&lt;/a&gt;Description&quot;">​</a></h2><p>This command rolls back all commands that were run after the savepoint was established. The savepoint remains valid and can be rolled back to again later, if needed.</p><p><code>ROLLBACK TO SAVEPOINT</code> implicitly destroys all savepoints that were established after the named savepoint.</p><h2 id="parameters" tabindex="-1"><a id="section4"></a>Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to &quot;&lt;a id=&quot;section4&quot;&gt;&lt;/a&gt;Parameters&quot;">​</a></h2><p>WORK TRANSACTION : Optional key words. They have no effect.</p><p>savepoint_name : The name of the savepoint to roll back to.</p><h2 id="notes" tabindex="-1"><a id="section5"></a>Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;&lt;a id=&quot;section5&quot;&gt;&lt;/a&gt;Notes&quot;">​</a></h2><p>Use <a href="./RELEASE_SAVEPOINT.html">RELEASE SAVEPOINT</a> to destroy a savepoint without discarding the effects of commands run after it was established.</p><p>Specifying a savepoint name that has not been established is an error.</p><p>Cursors have somewhat non-transactional behavior with respect to savepoints. Any cursor that is opened inside a savepoint will be closed when the savepoint is rolled back. If a previously opened cursor is affected by a <code>FETCH</code> command inside a savepoint that is later rolled back, the cursor remains at the position that <code>FETCH</code> left it pointing to (that is, cursor motion caused by <code>FETCH</code> is not rolled back). Closing a cursor is not undone by rolling back, either. However, other side-effects caused by the cursor&#39;s query (such as side-effects of volatile functions called by the query) <em>are</em> rolled back if they occur during a savepoint that is later rolled back. A cursor whose execution causes a transaction to end prematurely is put in a cannot-execute state, so while the transaction can be restored using <code>ROLLBACK TO SAVEPOINT</code>, the cursor can no longer be used.</p><h2 id="examples" tabindex="-1"><a id="section6"></a>Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;&lt;a id=&quot;section6&quot;&gt;&lt;/a&gt;Examples&quot;">​</a></h2><p>To undo the effects of the commands run after <code>my_savepoint</code> was established:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ROLLBACK TO SAVEPOINT my_savepoint;</span></span></code></pre></div><p>Cursor positions are not affected by a savepoint rollback:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>BEGIN;</span></span>
<span class="line"><span>DECLARE foo CURSOR FOR SELECT 1 UNION SELECT 2;</span></span>
<span class="line"><span>SAVEPOINT foo;</span></span>
<span class="line"><span>FETCH 1 FROM foo;</span></span>
<span class="line"><span>column </span></span>
<span class="line"><span>----------</span></span>
<span class="line"><span>        1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ROLLBACK TO SAVEPOINT foo;</span></span>
<span class="line"><span>FETCH 1 FROM foo;</span></span>
<span class="line"><span>column </span></span>
<span class="line"><span>----------</span></span>
<span class="line"><span>        2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>COMMIT;</span></span></code></pre></div><h2 id="compatibility" tabindex="-1"><a id="section7"></a>Compatibility <a class="header-anchor" href="#compatibility" aria-label="Permalink to &quot;&lt;a id=&quot;section7&quot;&gt;&lt;/a&gt;Compatibility&quot;">​</a></h2><p>The SQL standard specifies that the key word <code>SAVEPOINT</code> is mandatory, but WarehousePG (and Oracle) allow it to be omitted. SQL allows only <code>WORK</code>, not <code>TRANSACTION</code>, as a noise word after <code>ROLLBACK</code>. Also, SQL has an optional clause <code>AND [NO] CHAIN</code> which is not currently supported by WarehousePG. Otherwise, this command conforms to the SQL standard.</p><h2 id="see-also" tabindex="-1"><a id="section8"></a>See Also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;&lt;a id=&quot;section8&quot;&gt;&lt;/a&gt;See Also&quot;">​</a></h2><p><a href="./BEGIN.html">BEGIN</a>, <a href="./COMMIT.html">COMMIT</a>, <a href="./RELEASE_SAVEPOINT.html">RELEASE SAVEPOINT</a>, <a href="./ROLLBACK.html">ROLLBACK</a>, <a href="./SAVEPOINT.html">SAVEPOINT</a></p><p><strong>Parent topic:</strong> <a href="./../sql_commands/sql_ref.html">SQL Commands</a></p>`,24)]))}const m=e(o,[["render",i]]);export{u as __pageData,m as default};
