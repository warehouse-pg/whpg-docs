import{_ as t,c as a,o,ag as s}from"./chunks/framework.Ds6Eueu6.js";const h=JSON.parse('{"title":"greenplum_fdw","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/ref_guide/modules/greenplum_fdw.md","filePath":"docs/7x/ref_guide/modules/greenplum_fdw.md"}'),n={name:"docs/7x/ref_guide/modules/greenplum_fdw.md"};function r(i,e,c,d,l,p){return o(),a("div",null,e[0]||(e[0]=[s(`<h1 id="greenplum-fdw" tabindex="-1">greenplum_fdw <a class="header-anchor" href="#greenplum-fdw" aria-label="Permalink to &quot;greenplum_fdw&quot;">​</a></h1><hr><p>The <code>greenplum_fdw</code> module is a foreign-data wrapper (FDW) that you can use to run queries between one or more WarehousePG version 6.20+ and 7 clusters.</p><p>The WarehousePG <code>greenplum_fdw</code> module is an MPP extension of the PostgreSQL <code>postgres_fdw</code> module.</p><h2 id="installing-and-registering-the-module" tabindex="-1"><a id="topic_reg"></a>Installing and Registering the Module <a class="header-anchor" href="#installing-and-registering-the-module" aria-label="Permalink to &quot;&lt;a id=&quot;topic_reg&quot;&gt;&lt;/a&gt;Installing and Registering the Module&quot;">​</a></h2><p>The <code>greenplum_fdw</code> module is installed when you install WarehousePG. Before you can use this FDW, you must register the <code>greenplum_fdw</code> extension in each database in the local WarehousePG cluster in which you plan to use it:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE EXTENSION greenplum_fdw;</span></span></code></pre></div><p>Refer to <a href="./../../install_guide/install_extensions.html">Installing Extensions</a> for more information about installing and registering modules in WarehousePG.</p><h2 id="about-the-greenplum-fdw-module" tabindex="-1"><a id="topic_about"></a>About the greenplum_fdw Module <a class="header-anchor" href="#about-the-greenplum-fdw-module" aria-label="Permalink to &quot;&lt;a id=&quot;topic_about&quot;&gt;&lt;/a&gt;About the greenplum\\_fdw Module&quot;">​</a></h2><p><code>greenplum_fdw</code> is an MPP version of the <a href="https://www.postgresql.org/docs/12/postgres-fdw.html" target="_blank" rel="noreferrer">postgres_fdw</a> foreign-data wrapper. While it behaves similarly to <code>postgres_fdw</code> in many respects, <code>greenplum_fdw</code> uses a WarehousePG <em>parallel retrieve cursor</em> to pull data directly from the segments of a remote WarehousePG cluster to the segments in the local WarehousePG cluster, in parallel.</p><p><code>greenplum_fdw</code> for WarehousePG 7 supports predicate pushdown, which minimizes the amount of data transferred between the WarehousePG clusters by sending a query filter condition to the remote WarehousePG server where it is applied there. When more efficient, <code>greenplum_fdw</code> also performs <code>JOIN</code>s, aggregate functions (such as <code>count()</code>, <code>max()</code>, <code>avg()</code>), and <code>ORDER BY</code> and <code>LIMIT</code> operations on the remote WarehousePG server.</p><h2 id="using-the-greenplum-fdw-module" tabindex="-1"><a id="topic_using"></a>Using the greenplum_fdw Module <a class="header-anchor" href="#using-the-greenplum-fdw-module" aria-label="Permalink to &quot;&lt;a id=&quot;topic_using&quot;&gt;&lt;/a&gt;Using the greenplum\\_fdw Module&quot;">​</a></h2><p>You will perform the following tasks when you use <code>greenplum_fdw</code> to access data that resides in a remote WarehousePG cluster(s):</p><ol><li><a href="#create_server">Create a server</a> to represent each remote WarehousePG to which you want to connect.</li><li><a href="#user_mapping">Create a user mapping</a> for each (local) WarehousePG user that you want to allow to access each server.</li><li><a href="#create_ftable">Create a foreign table</a> for each remote WarehousePG table that you want to access, or <a href="#import_fschema">import a foreign schema</a>.</li><li><a href="#query_ftable">Construct and run queries</a>.</li></ol><h3 id="creating-a-server" tabindex="-1"><a id="create_server"></a>Creating a Server <a class="header-anchor" href="#creating-a-server" aria-label="Permalink to &quot;&lt;a id=&quot;create_server&quot;&gt;&lt;/a&gt;Creating a Server&quot;">​</a></h3><p>To access a remote WarehousePG cluster, you must first create a foreign server object which specifies the host, port, and database connection details. You provide these connection parameters in the <code>OPTIONS</code> clause of the <a href="./../sql_commands/CREATE_SERVER.html">CREATE SERVER</a> command.</p><p>A foreign server using the <code>greenplum_fdw</code> foreign-data wrapper accepts and disallows the same options as that of a foreign server using the <code>postgres_fdw</code> FDW; refer to the <a href="https://www.postgresql.org/docs/12/postgres-fdw.html" target="_blank" rel="noreferrer">Connection Options</a> topic in the PostgreSQL <code>postgres_fdw</code> documentation for more information about these options.</p><p>To obtain the full benefits of the parallel transfer feature provided by <code>greenplum_fdw</code>, you must also specify:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>mpp_execute &#39;all segments&#39;</span></span></code></pre></div><p>and</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>num_segments &#39;&lt;num&gt;&#39;</span></span></code></pre></div><p>in the <code>OPTIONS</code> clause when you create the server. Set <code>&lt;num&gt;</code> to the number of segments in the remote WarehousePG cluster. If you do not provide the <code>num_segments</code> option, the default value is the number of segments on the local WarehousePG cluster.</p><p>The following example command creates a server named <code>gpc1_testdb</code> that will be used to access tables residing in the database named <code>testdb</code> on the remote 8-segment WarehousePG cluster whose coordinator is running on the host <code>gpc1_coordinator</code>, port <code>5432</code>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE SERVER gpc1_testdb FOREIGN DATA WRAPPER greenplum_fdw</span></span>
<span class="line"><span>    OPTIONS (host &#39;gpc1_coordinator&#39;, port &#39;5432&#39;, dbname &#39;testdb&#39;, mpp_execute &#39;all segments&#39;, num_segments &#39;8&#39;);</span></span></code></pre></div><h3 id="creating-a-user-mapping" tabindex="-1"><a id="user_mapping"></a>Creating a User Mapping <a class="header-anchor" href="#creating-a-user-mapping" aria-label="Permalink to &quot;&lt;a id=&quot;user_mapping&quot;&gt;&lt;/a&gt;Creating a User Mapping&quot;">​</a></h3><p>After you identify which users you will permit to access the remote WarehousePG cluster, you must create one or more mappings between a local WarehousePG user and a user on the remote WarehousePG cluster. You create these mappings with the <a href="./../sql_commands/CREATE_USER_MAPPING.html">CREATE USER MAPPING</a> command.</p><p>User mappings that you create may include the following <code>OPTIONS</code>:</p><table tabindex="0"><thead><tr><th>Option Name</th><th>Description</th><th>Default Value</th></tr></thead><tbody><tr><td>user</td><td>The name of the remote WarehousePG user to connect as.</td><td>The name of the current (local) WarehousePG user.</td></tr><tr><td>password</td><td>The password for user on the remote WarehousePG cluster.</td><td>No default value.</td></tr></tbody></table><blockquote><p><strong>Note</strong> Only a WarehousePG superuser may connect to a WarehousePG foreign server without password authentication. Always specify the <code>password</code> option for user mappings that you create for non-superusers.</p></blockquote><p>The following command creates a default user mapping on the local WarehousePG cluster to the user named <code>bill</code> on the remote WarehousePG cluster that allows access to the database identified by the <code>gpc1_testdb</code> server. Specifying the <code>PUBLIC</code> user name creates a mapping for all current and future users when no user-specific mapping is applicable.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE USER MAPPING FOR PUBLIC SERVER gpc1_testdb</span></span>
<span class="line"><span>    OPTIONS (user &#39;bill&#39;, password &#39;changeme&#39;);</span></span></code></pre></div><p>The remote user must have the appropriate privileges to access any table(s) of interest in the database identified by the specified <code>SERVER</code>.</p><p>If the mapping is used to access a foreign-data wrapper across multiple WarehousePG clusters, then the remote user also requires <code>SELECT</code> access to the <code>pg_catalog.gp_endpoints</code> view. For example:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>GRANT SELECT ON TABLE pg_catalog.gp_endpoints TO bill;</span></span></code></pre></div><h3 id="creating-a-foreign-table" tabindex="-1"><a id="create_ftable"></a>Creating a Foreign Table <a class="header-anchor" href="#creating-a-foreign-table" aria-label="Permalink to &quot;&lt;a id=&quot;create_ftable&quot;&gt;&lt;/a&gt;Creating a Foreign Table&quot;">​</a></h3><p>You invoke the <a href="./../sql_commands/CREATE_FOREIGN_TABLE.html">CREATE FOREIGN TABLE</a> command to create a foreign table. The column data types that you specify when you create the foreign table should exactly match those in the referenced remote table. It is also recommended that the columns be declared with exactly the same collations, if applicable, as the referenced columns of the remote table.</p><p>Because <code>greenplum_fdw</code> matches foreign table columns to the remote table by name, not position, you can create a foreign table with fewer columns, or with a different column order, than the underlying remote table.</p><p>Foreign tables that you create may include the following <code>OPTIONS</code>:</p><table tabindex="0"><thead><tr><th>Option Name</th><th>Description</th><th>Default Value</th></tr></thead><tbody><tr><td>schema_name</td><td>The name of the schema in which the remote WarehousePG table resides.</td><td>The name of the schema in which the foreign table resides.</td></tr><tr><td>table_name</td><td>The name of the remote WarehousePG table.</td><td>The name of the foreign table.</td></tr></tbody></table><p>The following command creates a foreign table named <code>f_gpc1_orders</code> that references a table named <code>orders</code> located in the <code>public</code> schema of the database identified by the <code>gpc1_testdb</code> server (<code>testdb</code>):</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE FOREIGN TABLE f_gpc1_orders ( id int, qty int, item text )</span></span>
<span class="line"><span>    SERVER gpc1_testdb OPTIONS (schema_name &#39;public&#39;, table_name &#39;orders&#39;);</span></span></code></pre></div><p>You can additionally specify column name mappings via <code>OPTIONS</code> that you provide in the column declaration of the foreign table. The <code>column_name</code> option identifies the name of the associated column in the remote WarehousePG table, and defaults to the foreign table column name when not specified.</p><h3 id="importing-a-foreign-schema" tabindex="-1"><a id="import_fschema"></a>Importing a Foreign Schema <a class="header-anchor" href="#importing-a-foreign-schema" aria-label="Permalink to &quot;&lt;a id=&quot;import_fschema&quot;&gt;&lt;/a&gt;Importing a Foreign Schema&quot;">​</a></h3><p>Use of <a href="./../../ref_guide/sql_commands/IMPORT_FOREIGN_SCHEMA.html">IMPORT FOREIGN SCHEMA</a> to create foreign tables that represent tables existing on a foreign server may be preferable to constructing foreign table definitions manually. This command creates foreign table definitions on the local server that match tables or views present on the remote server. If the remote tables to be imported have columns of user-defined data types, the local server must have compatible types of the same names.</p><p><code>greenplum_fdw</code> supports the same import options as described in the <a href="https://www.postgresql.org/docs/12/postgres-fdw.html" target="_blank" rel="noreferrer">Importing Options</a> topic in the PostgreSQL <code>postgres_fdw</code> documentation.</p><h3 id="constructing-and-running-queries" tabindex="-1"><a id="query_ftable"></a>Constructing and Running Queries <a class="header-anchor" href="#constructing-and-running-queries" aria-label="Permalink to &quot;&lt;a id=&quot;query_ftable&quot;&gt;&lt;/a&gt;Constructing and Running Queries&quot;">​</a></h3><p>You <code>SELECT</code> from a foreign table to access the data stored in the underlying remote WarehousePG table. By default, you can also modify the remote table using the <code>INSERT</code> command, provided that the remote user specified the user mapping has the privileges to perform these operations. (Refer to <a href="#topic_update">About the Updatability Option</a> for information about changing the updatability of foreign tables.)</p><p><code>greenplum_fdw</code> attempts to optimize remote queries to reduce the amount of data transferred from foreign servers. This is achieved by sending query <code>WHERE</code> clauses to the remote WarehousePG server for execution, and by not retrieving table columns that are not needed for the current query. To reduce the risk of misexecution of queries, <code>greenplum_fdw</code> does not send <code>WHERE</code> clauses to the remote server unless they use only built-in data types, operators, and functions. Operators and functions in the clauses must be <code>IMMUTABLE</code> as well.</p><p>When <code>greenplum_fdw</code> encounters a join between foreign tables on the same foreign server, it sends the entire join to the foreign server, unless it believes that it will be more efficient to fetch rows from each table individually, or unless the table references involved are subject to different user mappings. While sending the <code>JOIN</code> clauses, <code>greenplum_fdw</code> takes the same precautions as mentioned above for <code>WHERE</code> clauses.</p><p>You can run the <code>EXPLAIN VERBOSE</code> command to examine the query that is actually sent to the remote WarehousePG server for execution.</p><h2 id="additional-information" tabindex="-1"><a id="topic_other"></a>Additional Information <a class="header-anchor" href="#additional-information" aria-label="Permalink to &quot;&lt;a id=&quot;topic_other&quot;&gt;&lt;/a&gt;Additional Information&quot;">​</a></h2><p>For more information about <code>greenplum_fdw</code> remote execution, updatability, import, and cost estimation options, connection management, and transaction management, refer to the individual topics below.</p><h3 id="about-the-remote-execution-options" tabindex="-1"><a id="topic_remex"></a>About the Remote Execution Options <a class="header-anchor" href="#about-the-remote-execution-options" aria-label="Permalink to &quot;&lt;a id=&quot;topic_remex&quot;&gt;&lt;/a&gt;About the Remote Execution Options&quot;">​</a></h3><p>By default, only <code>WHERE</code> clauses using built-in operators and functions are considered for execution on the remote server. <code>greenplum_fdw</code> locally checks clauses that involve non-built-in functions after rows are fetched. If such functions are available on the remote server and can be relied on to produce the same results as they do locally, you can improve performance by sending such <code>WHERE</code> clauses for remote execution. This behavior can be controlled using the following option:</p><p>extensions : This option is a comma-separated list of names of WarehousePG extensions that are installed, in compatible versions, on both the local and remote servers. Functions and operators that are immutable and belong to a listed extension are considered shippable to the remote server. You can specify this option only for foreign servers, not per-table.</p><p>: When using the <code>extensions</code> option, you must ensure that the listed extensions exist and behave identically on both the local and remote servers. Otherwise, remote queries may fail or behave unexpectedly.</p><p>fetch_size : This option specifies the number of rows <code>greenplum_fdw</code> should retrieve in each fetch operation. You can specify this option for a foreign table or a foreign server. The option specified on a table overrides an option specified for the server. The default is <code>100</code>.</p><h3 id="about-the-updatability-option" tabindex="-1"><a id="topic_update"></a>About the Updatability Option <a class="header-anchor" href="#about-the-updatability-option" aria-label="Permalink to &quot;&lt;a id=&quot;topic_update&quot;&gt;&lt;/a&gt;About the Updatability Option&quot;">​</a></h3><p>By default, all foreign tables created with <code>greenplum_fdw</code> are assumed to be updatable. You can override this for a foreign server or a foreign table using the following option:</p><p><code>updatable</code> : Controls whether <code>greenplum_fdw</code> allows foreign tables to be modified using the <code>INSERT</code> command. The default is true.</p><p>Setting this option at the foreign table-level overrides a foreign server-level option setting.</p><p>If the remote table is not in fact updatable, Greeplum returns an error. Use of this option allows the error to be thrown locally without querying the remote server. Note that the <code>information_schema</code> views report a <code>greenplum_fdw</code> foreign table to be updatable (or not) according to the setting of this option, without any check of the remote server.</p><h3 id="about-the-import-options" tabindex="-1"><a id="topic_import"></a>About the Import Options <a class="header-anchor" href="#about-the-import-options" aria-label="Permalink to &quot;&lt;a id=&quot;topic_import&quot;&gt;&lt;/a&gt;About the Import Options&quot;">​</a></h3><p><code>greenplum_fdw</code> can import foreign table definitions using <a href="./../../ref_guide/sql_commands/IMPORT_FOREIGN_SCHEMA.html">IMPORT FOREIGN SCHEMA</a>. This command creates foreign table definitions on the local server that match tables or views present on the remote server. If the remote tables to be imported have columns of user-defined data types, the local server must have compatible types of the same names.</p><p><code>greenplum_fdw</code> supports the same importing options as described in the <a href="https://www.postgresql.org/docs/12/postgres-fdw.html" target="_blank" rel="noreferrer">Importing Options</a> topic in the PostgreSQL <code>postgres_fdw</code> documentation.</p><h3 id="about-the-cost-estimation-options" tabindex="-1"><a id="topic_costest"></a>About the Cost Estimation Options <a class="header-anchor" href="#about-the-cost-estimation-options" aria-label="Permalink to &quot;&lt;a id=&quot;topic_costest&quot;&gt;&lt;/a&gt;About the Cost Estimation Options&quot;">​</a></h3><p><code>greenplum_fdw</code> supports the same cost estimation options as described in the <a href="https://www.postgresql.org/docs/12/postgres-fdw.html" target="_blank" rel="noreferrer">Cost Estimation Options</a> topic in the PostgreSQL <code>postgres_fdw</code> documentation.</p><h3 id="about-connection-management" tabindex="-1"><a id="topic_connmgmt"></a>About Connection Management <a class="header-anchor" href="#about-connection-management" aria-label="Permalink to &quot;&lt;a id=&quot;topic_connmgmt&quot;&gt;&lt;/a&gt;About Connection Management&quot;">​</a></h3><p><code>greenplum_fdw</code> establishes a connection to a foreign server during the first query on any foreign table associated with the server. <code>greenplum_fdw</code> retains and reuses this connection for subsequent queries submitted in the same session. However, if multiple user identities (user mappings) are used to access the foreign server, <code>greenplum_fdw</code> establishes a connection for each user mapping.</p><h3 id="about-transaction-management" tabindex="-1"><a id="topic_transmgmt"></a>About Transaction Management <a class="header-anchor" href="#about-transaction-management" aria-label="Permalink to &quot;&lt;a id=&quot;topic_transmgmt&quot;&gt;&lt;/a&gt;About Transaction Management&quot;">​</a></h3><p><code>greenplum_fdw</code> manages transactions as described in the <a href="https://www.postgresql.org/docs/12/postgres-fdw.html" target="_blank" rel="noreferrer">Transaction Management</a> topic in the PostgreSQL <code>postgres_fdw</code> documentation.</p><h2 id="remote-query-execution-environment" tabindex="-1"><a id="topic_remqexec"></a> Remote Query Execution Environment <a class="header-anchor" href="#remote-query-execution-environment" aria-label="Permalink to &quot;&lt;a id=&quot;topic_remqexec&quot;&gt;&lt;/a&gt; Remote Query Execution Environment&quot;">​</a></h2><p>In the remote sessions opened by <code>greenplum_fdw</code>, the <code>search_path</code> parameter is set to just <code>pg_catalog</code>, so that only built-in objects are visible without schema qualification. This is not an issue for queries generated by <code>greenplum_fdw</code> itself, because it always supplies such qualification. However, this can pose a hazard for functions that are run on the remote server via triggers or rules on remote tables. For example, if a remote table is actually a view, <code>greenplum_fdw</code> will run any functions used in that view with the restricted search path. Be sure to schema-qualify all names in such functions, or else attach <code>SET search_path</code> options (see <a href="./../sql_commands/CREATE_FUNCTION.html">CREATE FUNCTION</a>) to such functions to establish their expected search path environment.</p><p><code>greenplum_fdw</code> likewise establishes remote session settings for various parameters:</p><ul><li><code>TimeZone</code> is set to <code>UTC</code></li><li><code>DateStyle</code> is set to <code>ISO</code></li><li><code>IntervalStyle</code> is set to <code>postgres</code></li><li><code>extra_float_digits</code> is set to <code>3</code></li></ul><p>These parameters are likely to be less problematic than <code>search_path</code>, but can be handled with function <code>SET</code> options if the need arises.</p><p>Do not override this behavior by changing the session-level settings of these parameters; that is likely to cause <code>greenplum_fdw</code> to malfunction.</p><h2 id="about-using-resource-groups-to-limit-concurrency" tabindex="-1"><a id="resgroups"></a>About Using Resource Groups to Limit Concurrency <a class="header-anchor" href="#about-using-resource-groups-to-limit-concurrency" aria-label="Permalink to &quot;&lt;a id=&quot;resgroups&quot;&gt;&lt;/a&gt;About Using Resource Groups to Limit Concurrency&quot;">​</a></h2><p>You can create a dedicated user and resource group to manage <code>greenplum_fdw</code> concurrency on the remote WarehousePG clusters. In the following example scenario, local cluster 2 reads data from remote cluster 1.</p><p>Remote cluster (1) configuration:</p><ol><li><p>Create a dedicated WarehousePG user/role to represent the <code>greenplum_fdw</code> users on cluster 2 that initiate queries. For example, to create a role named <code>gpcluster2_users</code>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE ROLE gpcluster2_users;</span></span></code></pre></div></li><li><p>Create a dedicated resource group to manage resources for these users:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE RESOURCE GROUP rg_gpcluster2_users with (concurrency=2, cpu_max_percent=20);</span></span>
<span class="line"><span>ALTER ROLE gpcluster2_users RESOURCE GROUP rg_gpcluster2_users;</span></span></code></pre></div><p>When you configure the remote cluster as described above, the <code>rg_gpcluster2_users</code> resource group manages the resources used by all queries that are initiated by <code>gpcluster2_users</code>.</p></li></ol><p>Local cluster (2) configuration:</p><ol><li><p>Create a <code>greenplum_fdw</code> foreign server to access the remote cluster. For example, to create a server named <code>gpc1_testdb</code> that accesses the <code>testdb</code> database:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE SERVER gpc1_testdb FOREIGN DATA WRAPPER greenplum_fdw</span></span>
<span class="line"><span>    OPTIONS (host &#39;gpc1_coordinator&#39;, port &#39;5432&#39;, dbname &#39;testdb&#39;, mpp_execute &#39;all segments&#39;, );</span></span></code></pre></div></li><li><p>Map local users of the <code>greenplum_fdw</code> foreign server to the remote role. For example, to map specific users of the <code>gpc1_testdb</code> server on the local cluster to the <code>gpcluster2_users</code> role on the remote cluster:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE USER MAPPING FOR greenplum_fdw_user1 SERVER gpc1_testdb</span></span>
<span class="line"><span>    OPTIONS (user ‘gpcluster2_users’, password ‘changeme’);</span></span>
<span class="line"><span>CREATE USER MAPPING FOR greenplum_fdw_user2 SERVER gpc1_testdb</span></span>
<span class="line"><span>    OPTIONS (user ‘gpcluster2_users’, password ‘changeme’);</span></span></code></pre></div></li><li><p>Create a foreign table referencing a table on the remote cluster. For example to create a foreign table that references table <code>t1</code> on the remote cluster:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE FOREIGN TABLE table_on_cluster1 ( tc1 int )</span></span>
<span class="line"><span>  SERVER gpc1_testdb</span></span>
<span class="line"><span>  OPTIONS (schema_name &#39;public&#39;, table_name &#39;t1&#39;, mpp_execute &#39;all segments&#39;);</span></span></code></pre></div></li></ol><p>All local queries on foreign table <code>table_on_cluster1</code> are bounded on the remote cluster by the <code>rg_gpcluster2_users</code> resource group limits.</p><h2 id="known-issues-and-limitations" tabindex="-1"><a id="topic_limits"></a>Known Issues and Limitations <a class="header-anchor" href="#known-issues-and-limitations" aria-label="Permalink to &quot;&lt;a id=&quot;topic_limits&quot;&gt;&lt;/a&gt;Known Issues and Limitations&quot;">​</a></h2><p>The <code>greenplum_fdw</code> module has the following known issues and limitations:</p><ul><li>The <code>UPDATE</code> and <code>DELETE</code> commands are not supported.</li><li>The <code>FOR SHARE</code> and <code>FOR UPDATE</code> <code>SELECT</code> clauses are not supported.</li><li>Triggers for statements are not supported.</li><li>Pushdown for grouping sets and window aggregates is not supported.</li><li><code>greenplum_fdw</code> pushes down only a nested aggregate, not the <code>DISTINCT</code> itself.</li></ul><h2 id="compatibility" tabindex="-1"><a id="topic_compat"></a>Compatibility <a class="header-anchor" href="#compatibility" aria-label="Permalink to &quot;&lt;a id=&quot;topic_compat&quot;&gt;&lt;/a&gt;Compatibility&quot;">​</a></h2><p>You can use <code>greenplum_fdw</code> to access other remote WarehousePG clusters running version 6.20+ and 7.</p><h2 id="example" tabindex="-1"><a id="topic_examples"></a>Example <a class="header-anchor" href="#example" aria-label="Permalink to &quot;&lt;a id=&quot;topic_examples&quot;&gt;&lt;/a&gt;Example&quot;">​</a></h2><p>In this example, you query data residing in a database named <code>rdb</code> on the remote 16-segment WarehousePG cluster whose coordinator is running on host <code>gpc2_coordinator</code>, port <code>5432</code>:</p><ol><li><p>Initiate a <code>psql</code> session to the database named <code>testdb</code> on the local WarehousePG coordinator host:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ psql -d testdb</span></span></code></pre></div></li><li><p>Register the <code>greenplum_fdw</code> extension in the database if it does not already exist:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE EXTENSION IF NOT EXISTS greenplum_fdw;</span></span></code></pre></div></li><li><p>Create a server to access the remote WarehousePG cluster:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE SERVER gpc2_rdb FOREIGN DATA WRAPPER greenplum_fdw</span></span>
<span class="line"><span>    OPTIONS (host &#39;gpc2_coordinator&#39;, port &#39;5432&#39;, dbname &#39;rdb&#39;, mpp_execute &#39;all segments&#39;, num_segments &#39;16&#39;);</span></span></code></pre></div></li><li><p>Create a user mapping for a user named <code>jane</code> on the local WarehousePG cluster and the user named <code>john</code> on the remote WarehousePG cluster and database represented by the server named <code>gpc2_rdb</code>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE USER MAPPING FOR jane SERVER gpc2_rdb OPTIONS (user &#39;john&#39;, password &#39;changeme&#39;);</span></span></code></pre></div></li><li><p>Create a foreign table named <code>f_gpc2_emea</code> to reference the table named <code>emea</code> that is resides in the <code>public</code> schema of the database identified by the <code>gpc2_rdb</code> server (<code>rdb</code>):</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE FOREIGN TABLE f_gpc2_emea( bu text, income int )</span></span>
<span class="line"><span>    SERVER gpcs2_rdb OPTIONS (schema_name &#39;public&#39;, table_name &#39;emea&#39;);</span></span></code></pre></div></li><li><p>Query the foreign table:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SELECT * FROM f_gpc2_emea;</span></span></code></pre></div></li><li><p>Join the results of a foreign table query with a local table named <code>amer</code> that has similarly-named columns:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SELECT amer.bu, amer.income as amer_in, f_gpc2_emea.income as emea_in</span></span>
<span class="line"><span>    FROM amer, f_gpc2_emea</span></span>
<span class="line"><span>    WHERE amer.bu = f_gpc2_emea.bu;</span></span></code></pre></div></li></ol>`,92)]))}const m=t(n,[["render",r]]);export{h as __pageData,m as default};
