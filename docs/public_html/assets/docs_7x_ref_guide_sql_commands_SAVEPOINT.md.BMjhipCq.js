import{_ as a,c as i,o as e,ag as n}from"./chunks/framework.Ds6Eueu6.js";const c=JSON.parse('{"title":"SAVEPOINT","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/ref_guide/sql_commands/SAVEPOINT.md","filePath":"docs/7x/ref_guide/sql_commands/SAVEPOINT.md"}'),t={name:"docs/7x/ref_guide/sql_commands/SAVEPOINT.md"};function l(p,s,h,o,r,d){return e(),i("div",null,s[0]||(s[0]=[n(`<h1 id="savepoint" tabindex="-1">SAVEPOINT <a class="header-anchor" href="#savepoint" aria-label="Permalink to &quot;SAVEPOINT&quot;">​</a></h1><p>Defines a new savepoint within the current transaction.</p><h2 id="synopsis" tabindex="-1"><a id="section2"></a>Synopsis <a class="header-anchor" href="#synopsis" aria-label="Permalink to &quot;&lt;a id=&quot;section2&quot;&gt;&lt;/a&gt;Synopsis&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SAVEPOINT &lt;savepoint_name&gt;</span></span></code></pre></div><h2 id="description" tabindex="-1"><a id="section3"></a>Description <a class="header-anchor" href="#description" aria-label="Permalink to &quot;&lt;a id=&quot;section3&quot;&gt;&lt;/a&gt;Description&quot;">​</a></h2><p><code>SAVEPOINT</code> establishes a new savepoint within the current transaction.</p><p>A savepoint is a special mark inside a transaction that allows all commands that are run after it was established to be rolled back, restoring the transaction state to what it was at the time of the savepoint.</p><h2 id="parameters" tabindex="-1"><a id="section4"></a>Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to &quot;&lt;a id=&quot;section4&quot;&gt;&lt;/a&gt;Parameters&quot;">​</a></h2><p>savepoint_name : The name of the new savepoint. If savepoints with the same name already exist, they are inaccessible until newer identically-named savepoints are released.</p><h2 id="notes" tabindex="-1"><a id="section5"></a>Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;&lt;a id=&quot;section5&quot;&gt;&lt;/a&gt;Notes&quot;">​</a></h2><p>Use <a href="./ROLLBACK_TO_SAVEPOINT.html">ROLLBACK TO SAVEPOINT</a> to rollback to a savepoint. Use <a href="./RELEASE_SAVEPOINT.html">RELEASE SAVEPOINT</a> to destroy a savepoint, keeping the effects of commands run after it was established.</p><p>Savepoints can be established only inside a transaction block. You can define multiple savepoints within a transaction.</p><h2 id="examples" tabindex="-1"><a id="section6"></a>Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;&lt;a id=&quot;section6&quot;&gt;&lt;/a&gt;Examples&quot;">​</a></h2><p>To establish a savepoint and later undo the effects of all commands run after it was established:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>BEGIN;</span></span>
<span class="line"><span>    INSERT INTO table1 VALUES (1);</span></span>
<span class="line"><span>    SAVEPOINT my_savepoint;</span></span>
<span class="line"><span>    INSERT INTO table1 VALUES (2);</span></span>
<span class="line"><span>    ROLLBACK TO SAVEPOINT my_savepoint;</span></span>
<span class="line"><span>    INSERT INTO table1 VALUES (3);</span></span>
<span class="line"><span>COMMIT;</span></span></code></pre></div><p>The above transaction inserts the values 1 and 3, but not 2.</p><p>To establish and later destroy a savepoint:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>BEGIN;</span></span>
<span class="line"><span>    INSERT INTO table1 VALUES (3);</span></span>
<span class="line"><span>    SAVEPOINT my_savepoint;</span></span>
<span class="line"><span>    INSERT INTO table1 VALUES (4);</span></span>
<span class="line"><span>    RELEASE SAVEPOINT my_savepoint;</span></span>
<span class="line"><span>COMMIT;</span></span></code></pre></div><p>The above transaction inserts both 3 and 4.</p><p>To use a single savepoint name:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SAVEPOINT my_savepoint;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SAVEPOINT my_savepoint;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    -- rollback to the second savepoint</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ROLLBACK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SAVEPOINT my_savepoint;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table1;               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- shows rows 1 and 2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    -- release the second savepoint</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    RELEASE SAVEPOINT my_savepoint;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    -- rollback to the first savepoint</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ROLLBACK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SAVEPOINT my_savepoint;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table1;               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- shows only row 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COMMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>The above transaction shows row 3 being rolled back first, then row 2.</p><h2 id="compatibility" tabindex="-1"><a id="section7"></a>Compatibility <a class="header-anchor" href="#compatibility" aria-label="Permalink to &quot;&lt;a id=&quot;section7&quot;&gt;&lt;/a&gt;Compatibility&quot;">​</a></h2><p>SQL requires a savepoint to be destroyed automatically when another savepoint with the same name is established. In WarehousePG, the old savepoint is kept, though only the more recent one is used when rolling back or releasing. (Releasing the newer savepoint will cause the older one to again become accessible to <a href="./ROLLBACK_TO_SAVEPOINT.html">ROLLBACK TO SAVEPOINT</a> and <a href="./RELEASE_SAVEPOINT.html">RELEASE SAVEPOINT</a>.) Otherwise, <code>SAVEPOINT</code> is fully SQL conforming.</p><h2 id="see-also" tabindex="-1"><a id="section8"></a>See Also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;&lt;a id=&quot;section8&quot;&gt;&lt;/a&gt;See Also&quot;">​</a></h2><p><a href="./BEGIN.html">BEGIN</a>, <a href="./COMMIT.html">COMMIT</a>, <a href="./RELEASE_SAVEPOINT.html">RELEASE SAVEPOINT</a>, <a href="./ROLLBACK.html">ROLLBACK</a>, <a href="./ROLLBACK_TO_SAVEPOINT.html">ROLLBACK TO SAVEPOINT</a></p><p><strong>Parent topic:</strong> <a href="./../sql_commands/sql_ref.html">SQL Commands</a></p>`,27)]))}const E=a(t,[["render",l]]);export{c as __pageData,E as default};
