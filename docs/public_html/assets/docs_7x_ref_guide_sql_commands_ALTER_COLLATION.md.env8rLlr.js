import{_ as a,c as t,o as s,ag as n}from"./chunks/framework.Ds6Eueu6.js";const u=JSON.parse('{"title":"ALTER COLLATION","description":"","frontmatter":{},"headers":[],"relativePath":"docs/7x/ref_guide/sql_commands/ALTER_COLLATION.md","filePath":"docs/7x/ref_guide/sql_commands/ALTER_COLLATION.md"}'),o={name:"docs/7x/ref_guide/sql_commands/ALTER_COLLATION.md"};function i(l,e,c,r,d,p){return s(),t("div",null,e[0]||(e[0]=[n(`<h1 id="alter-collation" tabindex="-1">ALTER COLLATION <a class="header-anchor" href="#alter-collation" aria-label="Permalink to &quot;ALTER COLLATION&quot;">​</a></h1><p>Changes the definition of a collation.</p><h2 id="synopsis" tabindex="-1"><a id="section2"></a>Synopsis <a class="header-anchor" href="#synopsis" aria-label="Permalink to &quot;&lt;a id=&quot;section2&quot;&gt;&lt;/a&gt;Synopsis&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ALTER COLLATION &lt;name&gt; REFRESH VERSION</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ALTER COLLATION &lt;name&gt; RENAME TO &lt;new_name&gt;</span></span>
<span class="line"><span>ALTER COLLATION &lt;name&gt; OWNER TO { &lt;new_owner&gt; | CURRENT_USER | SESSION_USER }</span></span>
<span class="line"><span>ALTER COLLATION &lt;name&gt; SET SCHEMA &lt;new_schema&gt;</span></span></code></pre></div><h2 id="description" tabindex="-1"><a id="section3"></a>Description <a class="header-anchor" href="#description" aria-label="Permalink to &quot;&lt;a id=&quot;section3&quot;&gt;&lt;/a&gt;Description&quot;">​</a></h2><p><code>ALTER COLLATION</code> changes the definition of a collation.</p><p>You must own the collation to use <code>ALTER COLLATION</code>. To alter the owner, you must also be a direct or indirect member of the new owning role, and that role must have <code>CREATE</code> privilege on the collation&#39;s schema. (These restrictions enforce that altering the owner doesn&#39;t do anything you couldn&#39;t do by dropping and recreating the collation. However, a superuser can alter ownership of any collation anyway.)</p><h2 id="parameters" tabindex="-1"><a id="section4"></a>Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to &quot;&lt;a id=&quot;section4&quot;&gt;&lt;/a&gt;Parameters&quot;">​</a></h2><p>name : The name (optionally schema-qualified) of an existing collation.</p><p>new_name : The new name of the collation.</p><p>new_owner : The new owner of the collation.</p><p>new_schema : The new schema for the collation.</p><p>REFRESH VERSION : Update the collation&#39;s version. See the <a href="#section4a">Notes</a> below.</p><h2 id="notes" tabindex="-1"><a id="section4a"></a>Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;&lt;a id=&quot;section4a&quot;&gt;&lt;/a&gt;Notes&quot;">​</a></h2><p>When using collations provided by the ICU library, the ICU-specific version of the collator is recorded in the system catalog when the collation object is created. When the collation is used, the current version is checked against the recorded version, and a warning is issued when there is a mismatch, for example:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>WARNING:  collation &quot;xx-x-icu&quot; has version mismatch</span></span>
<span class="line"><span>DETAIL:  The collation in the database was created using version 1.2.3.4, but the operating system provides version 2.3.4.5.</span></span>
<span class="line"><span>HINT:  Rebuild all objects affected by this collation and run ALTER COLLATION pg_catalog.&quot;xx-x-icu&quot; REFRESH VERSION, or build PostgreSQL with the right library version.</span></span></code></pre></div><p>A change in collation definitions can lead to corrupt indexes and other problems because the database system relies on stored objects having a certain sort order. Generally, this should be avoided, but it can happen in legitimate circumstances, such as when using <code>pg_upgrade</code> to upgrade to server binaries linked with a newer version of ICU. When this happens, all objects depending on the collation should be rebuilt, for example, using <code>REINDEX</code>. When that is done, the collation version can be refreshed using the command <code>ALTER COLLATION ... REFRESH VERSION</code>. This will update the system catalog to record the current collator version and will make the warning go away. Note that this does not actually check whether all affected objects have been rebuilt correctly.</p><p>The following query can be used to identify all collations in the current database that need to be refreshed and the objects that depend on them:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SELECT pg_describe_object(refclassid, refobjid, refobjsubid) AS &quot;Collation&quot;,</span></span>
<span class="line"><span>       pg_describe_object(classid, objid, objsubid) AS &quot;Object&quot;</span></span>
<span class="line"><span>  FROM pg_depend d JOIN pg_collation c</span></span>
<span class="line"><span>       ON refclassid = &#39;pg_collation&#39;::regclass AND refobjid = c.oid</span></span>
<span class="line"><span>  WHERE c.collversion &lt;&gt; pg_collation_actual_version(c.oid)</span></span>
<span class="line"><span>  ORDER BY 1, 2;</span></span></code></pre></div><h2 id="examples" tabindex="-1"><a id="section5"></a>Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;&lt;a id=&quot;section5&quot;&gt;&lt;/a&gt;Examples&quot;">​</a></h2><p>To rename the collation de_DE to <code>german</code>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ALTER COLLATION &quot;de_DE&quot; RENAME TO german;</span></span></code></pre></div><p>To change the owner of the collation <code>en_US</code> to <code>joe</code>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ALTER COLLATION &quot;en_US&quot; OWNER TO joe;</span></span></code></pre></div><h2 id="compatibility" tabindex="-1"><a id="section6"></a>Compatibility <a class="header-anchor" href="#compatibility" aria-label="Permalink to &quot;&lt;a id=&quot;section6&quot;&gt;&lt;/a&gt;Compatibility&quot;">​</a></h2><p>There is no <code>ALTER COLLATION</code> statement in the SQL standard.</p><h2 id="see-also" tabindex="-1"><a id="section7"></a>See Also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;&lt;a id=&quot;section7&quot;&gt;&lt;/a&gt;See Also&quot;">​</a></h2><p><a href="./CREATE_COLLATION.html">CREATE COLLATION</a>, <a href="./DROP_COLLATION.html">DROP COLLATION</a></p><p><strong>Parent topic:</strong> <a href="./../sql_commands/sql_ref.html">SQL Commands</a></p>`,29)]))}const g=a(o,[["render",i]]);export{u as __pageData,g as default};
